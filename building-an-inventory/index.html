<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>building an inventory view of SQL Servers with dbatools &ndash; dbatools</title>
<link rel="dns-prefetch" href="//secure.gravatar.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//use.fontawesome.com">

<link rel="alternate" type="application/rss+xml" title="dbatools &raquo; Feed" href="https://dbatools.io/feed/">
<link rel="alternate" type="application/rss+xml" title="dbatools &raquo; Comments Feed" href="https://dbatools.io/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="dbatools &raquo; building an inventory view of SQL Servers with dbatools Comments Feed" href="https://dbatools.io/building-an-inventory/feed/">
<link rel="stylesheet" id="wp-block-library-css" href="https://c0.wp.com/c/5.3.4/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all">
<style id="wp-block-library-inline-css" type="text/css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="cpsh-shortcodes-css" href="https://dbatools.io/wp-content/plugins/column-shortcodes//assets/css/shortcodes.css?ver=1.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-fonts-css" href="https://fonts.googleapis.com/css?family=Raleway%3A400%2C500%2C600%2C700%2C300%2C100%2C800%2C900%7COpen+Sans%3A400%2C300%2C300italic%2C400italic%2C600%2C600italic%2C700%2C700italic&amp;subset=latin%2Clatin-ext&amp;ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-animate-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/animate.min.css?ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-fa-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/font-awesome.min.css?ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-bootstrap-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/bootstrap.min.css?ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-style-css" href="https://dbatools.io/wp-content/plugins/onepress-plus/style.css?ver=10.1.8" type="text/css" media="all">
<style id="onepress-style-inline-css" type="text/css">
#main .video-section section.hero-slideshow-wrapper{background:transparent}.hero-slideshow-wrapper:after{position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:rgba(1,36,86,1);display:block;content:""}.body-desktop .parallax-hero .hero-slideshow-wrapper:after{display:none!important}.parallax-hero .parallax-mirror:after{position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:rgba(1,36,86,1);display:block;content:""}.body-desktop .parallax-hero .hero-slideshow-wrapper:after{display:none!important}.parallax-hero .parallax-mirror:after{position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:rgba(1,36,86,1);display:block;content:""}a,.screen-reader-text:hover,.screen-reader-text:active,.screen-reader-text:focus,.header-social a,.onepress-menu a:hover,.onepress-menu ul li a:hover,.onepress-menu li.onepress-current-item>a,.onepress-menu ul li.current-menu-item>a,.onepress-menu>li a.menu-actived,.onepress-menu.onepress-menu-mobile li.onepress-current-item>a,.site-footer a,.site-footer .footer-social a:hover,.site-footer .btt a:hover,.highlight,#comments .comment .comment-wrapper .comment-meta .comment-time:hover,#comments .comment .comment-wrapper .comment-meta .comment-reply-link:hover,#comments .comment .comment-wrapper .comment-meta .comment-edit-link:hover,.btn-theme-primary-outline,.sidebar .widget a:hover,.section-services .service-item .service-image i,.counter_item .counter__number,.team-member .member-thumb .member-profile a:hover,.icon-background-default{color:#012456}input[type="reset"],input[type="submit"],input[type="submit"],.nav-links a:hover,.btn-theme-primary,.btn-theme-primary-outline:hover,.card-theme-primary,.woocommerce #respond input#submit,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce button.button.alt{background:#012456}.btn-theme-primary-outline,.btn-theme-primary-outline:hover,.pricing__item:hover,.card-theme-primary,.entry-content blockquote{border-color:#012456}.site-header{background:#e3e3e3;border-bottom:0px none}.onepress-menu>li>a{color:#293955}.onepress-menu>li>a:hover,.onepress-menu>li.onepress-current-item>a{color:#444444;-webkit-transition:all 0.5s ease-in-out;-moz-transition:all 0.5s ease-in-out;-o-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}#nav-toggle span,#nav-toggle span::before,#nav-toggle span::after,#nav-toggle.nav-is-visible span::before,#nav-toggle.nav-is-visible span::after{background:#293955}.site-footer{background-color:#012456}.site-footer .footer-connect .follow-heading{color:rgba(255,255,255,0.9)}.site-footer .site-info,.site-footer .btt a{background-color:#545454}.site-footer .site-info{color:rgba(255,255,255,0.7)}.site-footer .btt a,.site-footer .site-info a{color:rgba(255,255,255,0.9)}.gallery-carousel .g-item{padding:0px 10px}.gallery-carousel{margin-left:-10px;margin-right:-10px}.gallery-grid .g-item,.gallery-masonry .g-item .inner{padding:10px}.gallery-grid,.gallery-masonry{margin:-10px}
/* --- Begin custom CSS --- */
.section-testimonials .card { max-width : 140px; }
/* --- End custom CSS --- */

 .section-features{ background-color: rgba(227,227,227,1); } 
 
</style>
<link rel="stylesheet" id="onepress-gallery-lightgallery-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/lightgallery.css?ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="upw_theme_standard-css" href="https://dbatools.io/wp-content/plugins/ultimate-posts-widget/css/upw-theme-standard.min.css?ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-official-css" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" type="text/css" media="all" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
<link rel="stylesheet" id="onepress-child-style-css" href="https://dbatools.io/wp-content/themes/onepress/style.css?ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="sccss_style-css" href="https://dbatools.io/?sccss=1&amp;ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-official-v4shim-css" href="https://use.fontawesome.com/releases/v5.11.2/css/v4-shims.css" type="text/css" media="all" integrity="sha384-/EdpJd7d6gGFiQ/vhh7iOjiZdf4+6K4al/XrX6FxxZwDSrAdWxAynr4p/EA/vyPQ" crossorigin="anonymous">
<style id="font-awesome-official-v4shim-inline-css" type="text/css">
@font-face {
font-family: "FontAwesome";
src: url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.eot"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.eot?#iefix") format("embedded-opentype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.woff2") format("woff2"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.woff") format("woff"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.ttf") format("truetype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.svg#fontawesome") format("svg");
}

@font-face {
font-family: "FontAwesome";
src: url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.eot"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.eot?#iefix") format("embedded-opentype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.woff2") format("woff2"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.woff") format("woff"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.ttf") format("truetype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.svg#fontawesome") format("svg");
}

@font-face {
font-family: "FontAwesome";
src: url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.eot"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.eot?#iefix") format("embedded-opentype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.woff2") format("woff2"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.woff") format("woff"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.ttf") format("truetype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.svg#fontawesome") format("svg");
unicode-range: U+F004-F005,U+F007,U+F017,U+F022,U+F024,U+F02E,U+F03E,U+F044,U+F057-F059,U+F06E,U+F070,U+F075,U+F07B-F07C,U+F080,U+F086,U+F089,U+F094,U+F09D,U+F0A0,U+F0A4-F0A7,U+F0C5,U+F0C7-F0C8,U+F0E0,U+F0EB,U+F0F3,U+F0F8,U+F0FE,U+F111,U+F118-F11A,U+F11C,U+F133,U+F144,U+F146,U+F14A,U+F14D-F14E,U+F150-F152,U+F15B-F15C,U+F164-F165,U+F185-F186,U+F191-F192,U+F1AD,U+F1C1-F1C9,U+F1CD,U+F1D8,U+F1E3,U+F1EA,U+F1F6,U+F1F9,U+F20A,U+F247-F249,U+F24D,U+F254-F25B,U+F25D,U+F267,U+F271-F274,U+F279,U+F28B,U+F28D,U+F2B5-F2B6,U+F2B9,U+F2BB,U+F2BD,U+F2C1-F2C2,U+F2D0,U+F2D2,U+F2DC,U+F2ED,U+F328,U+F358-F35B,U+F3A5,U+F3D1,U+F410,U+F4AD;
}
</style>
<link rel="stylesheet" id="jetpack_css-css" href="https://c0.wp.com/p/jetpack/8.4.2/css/jetpack.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var onepress_js_settings = {"onepress_disable_animation":"1","onepress_disable_sticky_header":"1","onepress_vertical_align_menu":"0","hero_animation":"flipInX","hero_speed":"5000000","is_home":"","gallery_enable":"1"};
var OnePress_Plus = {"ajax_url":"https:\/\/dbatools.io\/wp-admin\/admin-ajax.php","browser_warning":" Your browser does not support the video tag. I suggest you upgrade your browser."};
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/c/5.3.4/wp-includes/js/jquery/jquery.js"></script>
<script type="text/javascript" src="https://c0.wp.com/c/5.3.4/wp-includes/js/jquery/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/related-posts/related-posts.min.js"></script>


<link rel="prev" title="dbatools featured on sql with bert" href="https://dbatools.io/sqlbert/">
<link rel="next" title="30 day countdown to 1.0 starts today!" href="https://dbatools.io/30-day-countdown-to-1-0-starts-today/">


<link rel="alternate" type="application/json+oembed" href="https://dbatools.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdbatools.io%2Fbuilding-an-inventory%2F">
<link rel="alternate" type="text/xml+oembed" href="https://dbatools.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdbatools.io%2Fbuilding-an-inventory%2F&amp;format=xml">

<link rel="dns-prefetch" href="//v0.wordpress.com">
<link rel="dns-prefetch" href="//widgets.wp.com">
<link rel="dns-prefetch" href="//s0.wp.com">
<link rel="dns-prefetch" href="//0.gravatar.com">
<link rel="dns-prefetch" href="//1.gravatar.com">
<link rel="dns-prefetch" href="//2.gravatar.com">
<link rel="dns-prefetch" href="//i0.wp.com">
<link rel="dns-prefetch" href="//i1.wp.com">
<link rel="dns-prefetch" href="//i2.wp.com">
<link rel="dns-prefetch" href="//c0.wp.com">
<link rel="dns-prefetch" href="//jetpack.wordpress.com">
<link rel="dns-prefetch" href="//s1.wp.com">
<link rel="dns-prefetch" href="//s2.wp.com">
<link rel="dns-prefetch" href="//public-api.wordpress.com">
<style type="text/css">img#wpstats{display:none}</style><link rel="canonical" href="https://dbatools.io/building-an-inventory/">
			<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
			<script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
		

<meta property="og:type" content="article">
<meta property="og:title" content="building an inventory view of SQL Servers with dbatools">
<meta property="og:url" content="https://dbatools.io/building-an-inventory/">
<meta property="og:description" content="The situation Hey all, I am Andreas Schubert and I am working as a Principal Consultant and Database Reliability Engineer for SQL Server &amp; Azure for multiple national and international companie&hellip;">
<meta property="article:published_time" content="2019-04-25T11:10:37+00:00">
<meta property="article:modified_time" content="2019-06-16T12:59:27+00:00">
<meta property="og:site_name" content="dbatools">
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg">
<meta property="og:locale" content="en_US">
<meta name="twitter:text:title" content="building an inventory view of SQL Servers with dbatools">
<meta name="twitter:image" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1">
<meta name="twitter:card" content="summary">


<link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=32%2C32&amp;ssl=1" sizes="32x32">
<link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1">
<meta name="msapplication-TileImage" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1">

<style class="wp-typography-print-styles" type="text/css">
body, body p { 
	font-style: normal;
	text-transform: none;
 } 
 .onepress-menu a { 
	font-style: normal;
	text-transform: none;
 } 
 body h1, body h2, body h3, body h4, body h5, body h6,
    body .section-title-area .section-title, body .section-title-area .section-subtitle, body .hero-content-style1 h2 { 
	font-style: normal;
	text-transform: none;
 }
</style>
			<style type="text/css" id="wp-custom-css">
				/*
Welcome to Custom CSS!

To learn how this works, see http://wp.me/PEmnE-Bt
*/			</style>
		</head>

<body class="post-template-default single single-post postid-9595 single-format-standard wp-custom-logo group-blog no-sticky-header">
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
            <header id="masthead" class="site-header" role="banner">
            <div class="container">
                <div class="site-branding">
                <div class="site-brand-inner has-logo-img no-desc"><div class="site-logo-div"><a href="https://dbatools.io/" class="custom-logo-link" rel="home"><img width="223" height="64" src="https://i0.wp.com/dbatools.io/wp-content/uploads/2016/05/dbatools-logo-1.png?fit=223%2C64&amp;ssl=1" class="custom-logo jetpack-lazy-image" alt="dbatools" data-lazy-src="https://i0.wp.com/dbatools.io/wp-content/uploads/2016/05/dbatools-logo-1.png?fit=223%2C64&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "></a></div></div>                </div>
                

                <div class="header-right-wrapper">
                    <a href="#0" id="nav-toggle">Menu<span></span></a>
                    <nav id="site-navigation" class="main-navigation" role="navigation">
                        <ul class="onepress-menu">
                            <li id="menu-item-1452" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1452"><a href="https://dbatools.io/download/">&#11015; download</a>
<ul class="sub-menu">
	<li id="menu-item-1451" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1451"><a href="https://dbatools.io/getting-started/">get started</a></li>
</ul>
</li>
<li id="menu-item-1453" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1453"><a href="https://dbatools.io/commands/">&#128640; commands</a></li>
<li id="menu-item-8268" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-8268"><a href="https://dbatools.io/docs">&#128209; docs</a>
<ul class="sub-menu">
	<li id="menu-item-8270" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8270"><a href="https://dbatools.io/blog">blog</a></li>
</ul>
</li>
<li id="menu-item-1456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1456"><a href="https://dbatools.io/team/">&#129395; team</a>
<ul class="sub-menu">
	<li id="menu-item-3315" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3315"><a href="https://dbatools.io/contributing">contribute</a></li>
	<li id="menu-item-3123" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3123"><a href="https://dbatools.io/contact/">contact</a></li>
	<li id="menu-item-3116" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-3116"><a href="https://dbatools.io/git">find us</a>
	<ul class="sub-menu">
		<li id="menu-item-4663" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4663"><a href="https://dbatools.io/slack">slack</a></li>
		<li id="menu-item-4662" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4662"><a href="https://dbatools.io/github">github</a></li>
		<li id="menu-item-4664" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4664"><a href="https://dbatools.io/twitter">twitter</a></li>
		<li id="menu-item-4665" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4665"><a href="https://dbatools.io/youtube">youtube</a></li>
		<li id="menu-item-4666" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4666"><a href="https://dbatools.io/linkedin">linkedin</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-3340" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3340"><a href="https://dbatools.io/subscribe/">&#128140; subscribe</a></li>
<li id="menu-item-6587" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6587"><a href="https://dbatools.io/builds">&#10004; build ref</a></li>
<li id="menu-item-9781" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9781"><a href="https://dbatools.io/sponsorship/">&#128149; sponsor</a></li>
<li id="menu-item-9994" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9994"><a href="https://dbatools.io/book">&#128216; book</a></li>
                        </ul>
                    </nav>
                    
                </div>
            </div>
        </header>
        
	<div id="content" class="site-content">

		
		<div id="content-inside" class="container right-sidebar">
			<div id="primary" class="content-area">
				<main id="main" class="site-main" role="main">

				
					
<article id="post-9595" class="post-9595 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">
	<header class="entry-header">
		<h1 class="entry-title">building an inventory view of SQL Servers with dbatools</h1>
		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://dbatools.io/building-an-inventory/" rel="bookmark"><time class="entry-date published" datetime="2019-04-25T11:10:37+00:00">April 25, 2019</time><time class="updated hide" datetime="2019-06-16T12:59:27+00:00">June 16, 2019</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://dbatools.io/author/andreas/">Andreas</a></span></span>		</div>
	</header>

	<div class="entry-content">
		<h2>The situation</h2>
<p>Hey all, I am Andreas Schubert and I am working as a Principal Consultant and Database Reliability Engineer for SQL Server &amp; Azure for multiple national and international companies. My focus is on implementing and operating complex 24/7 SQL environments with tens and hundreds of servers and multi-terrabyte databases.</p>
<p>With the multitude of environments that I am operating, it&rsquo;s impossible to remember every server, every database or the multiple different ways they are interacting with each other. Therefore, one of the first things I do when taking over a consulting engagement is mapping out all those different bits of information.</p>
<p>Since the environments usually change pretty fast, my goal is to automate this process as much as possible.</p>
<p>In this series of posts, I will try to show you how I am implementing this. Of course, your requirements or implementations may differ, but hopefully this blog post can give you some ideas about your tasks too.</p>
<h2>Enter dbatools</h2>
<p>Before dbatools existed, I had to rely on either the various monitoring solutions that my customers are using or on scripts created by myself. There are a lot of really great 3rd party tools out there that do an awesome job. Unfortunately, they all differ in how they are used or what information they report back. I needed something that is easy to implement, with as few dependencies as possible and works across all SQL Server versions. That&rsquo;s when I started using dbatools.<br>
I immediately felt in love with how flexible it is. And boy, did its functionality grow fast!</p>
<p>Today, there are tons of commands available that cover almost all, of the various, areas SQL Server has to offer.</p>
<h2>The task</h2>
<p>Before I dive into specific SQL Servers for in-depth analysis, I want to see some sort of inventory. The minimum information I would like to collect is:</p>
<ul>
<li>What server is SQL running on?</li>
<li>What edition and patch level does it have?</li>
<li>How many cores and RAM is it equipped with?</li>
<li>How many databases are on the SQL, what size are they and what&rsquo;s the biggest one?</li>
<li>Is the SQL part of an Availability Group? If yes, what&rsquo;s the name of the AG, what role does the SQL have right now and what&rsquo;s the underlying cluster object name?</li>
<li>On top of that, I find that SQL Instances usually get a &ldquo;pet name&rdquo; alias. This means, when people within the company are talking about the SQL Server, they don&rsquo;t call it by it&rsquo;s machine name, but rather something like &ldquo;the production database&rdquo; or &ldquo;the cluster&rdquo;. Technically not correct, but that&rsquo;s how it is happening. Due to that, my overview should also contain that alias to make it easier for me until I remember all the mappings.</li>
</ul>
<p>Whoever has built an inventory script in the past knows that collecting the above information requires quite a few scripts. On top of that,  the underlying DMVs have been changed between SQL versions, so you need to account for that. Microsoft has made that much easier with providing SMO (SQL Server Management Objects), a set of libraries that abstract away the complexity of collecting that information. Thankfully, Microsoft also enabled the dbatools team to include SMO in their framework. My example solution relies solely on dbatools (which works &ndash; not only but also &ndash; with SMO).</p>
<p>OK, enough talk, let&rsquo;s jump straight into the code.</p>
<h2>The solution</h2>
<p>Right at the beginning of any of my scripts, I am defining the root of the script itself. I do this because I re-use a lot of functions.</p>
<p>Since we want to collect the information for more than one SQL Server instance, we will first build a list of SQL Servers. We could query the list of instances from a central management server, but for the purpose of this post &ndash; and portability- we will keep it simple. We will also assume the account executing this script will have sufficient permissions on each SQL Server instance and that it can connect via Windows Authentication. I generally prefer Windows Authentication over SQL Server authentication due to security concerns, but that is a completely separate topic.</p>
<p>The names of the Servers will be coming from a simple text file in our example. Just do me a favour and do NOT put your server list into an unsecured network location &ndash; again, we need to keep security in mind.</p>
<p><img src="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_servers.png?fit=300%2C300&amp;ssl=1" alt="Picture 1: our server list" class="alignnone size-medium wp-image-9600 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_servers.png?w=496&amp;ssl=1 496w, https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_servers.png?resize=300%2C178&amp;ssl=1 300w" data-lazy-sizes="(max-width: 496px) 100vw, 496px" data-lazy-src="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_servers.png?fit=300%2C300&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img src="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_servers.png?fit=300%2C300&amp;ssl=1" alt="Picture 1: our server list" class="alignnone size-medium wp-image-9600" srcset="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_servers.png?w=496&amp;ssl=1 496w,https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_servers.png?resize=300%2C178&amp;ssl=1 300w" sizes="(max-width: 496px) 100vw, 496px" data-recalc-dims="1"></noscript></p>
<p>Next, we need to load this file into our PowerShell session. For the sake of simplicity, I am loading it explicitely into my script. Normally, I have a variable populated with the servers in my profile, so I don&rsquo;t have to do this each time.</p>
<pre class="lang:ps decode:true ">$script:root = 'D:\AdminScripts'
$ProductionServers = Get-Content (Join-Path $script:root -ChildPath 'Production.txt')</pre>
<p>Similar to the actual server list, I am using a text file &ldquo;AliasList.txt&rdquo; to store the alias information i mentioned above:</p>
<p><img src="https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?fit=300%2C300&amp;ssl=1" alt="Picture 2: the alias list" class="alignnone size-medium wp-image-9598 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?w=1101&amp;ssl=1 1101w, https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?resize=300%2C60&amp;ssl=1 300w, https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?resize=768%2C153&amp;ssl=1 768w, https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?resize=1024%2C205&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?fit=300%2C300&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img src="https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?fit=300%2C300&amp;ssl=1" alt="Picture 2: the alias list" class="alignnone size-medium wp-image-9598" srcset="https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?w=1101&amp;ssl=1 1101w,https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?resize=300%2C60&amp;ssl=1 300w,https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?resize=768%2C153&amp;ssl=1 768w,https://i0.wp.com/dbatools.io/wp-content/uploads/2019/04/SQLInventory_aliasList.png?resize=1024%2C205&amp;ssl=1 1024w" sizes="(max-width: 800px) 100vw, 800px" data-recalc-dims="1"></noscript></p>
<p>It&acute;s the same system: the name of the server or instance, followed by the alias name. Both values are separated by a semicolon. Loading and storing the alias information in a hash table is a simple one-liner in PowerShell:</p>
<pre class="lang:ps decode:true ">$AliasList = Get-Content (Join-Path $script:root -ChildPath 'AliasList.txt') | Select @{Name= "Instance";Expression={$_.ToString().Split(';')[0]}},@{Name= "Alias";Expression={$_.ToString().Split(';')[1]}}</pre>
<p>Since I usually exclude system databases from my reports, I am defining a separate list of them as well for easier reuse:</p>
<pre class="lang:ps decode:true ">$systemDBs = "master","model","msdb","tempdb", "ReportServer","ReportServerTempDB"</pre>
<p>At this point, we have all the preliminaries completed: A list of SQL Servers to query, a list of system databases that we will exclude and a list of alias information. Let&rsquo;s hit the servers and put the resulting data into a variable. I&rsquo;ll first show the complete code block, then we will talk about what it does.</p>
<pre class="lang:ps decode:true ">$rawData = $ProductionServers | Connect-DbaInstance | Sort-Object Computername | Select-Object ComputerName,
    # map the SQL version
    @{Name="SQL Version";Expression={ if ($_.VersionMajor -eq "11") {"SQL 2012"} elseif ($_.VersionMajor -eq "12") {"SQL 2014"} elseif ($_.VersionMajor -eq "13") {"SQL 2016"}
    elseif ($_.VersionMajor -eq "14") {"SQL 2017"} elseif ($_.VersionMajor -eq "15") {"SQL 2019"} elseif ($_.VersionMajor -lt "11") {"SQL 2008R2 or older"} else {"unknown"}}},
    ProductLevel, Edition,
    # RAM
    @{Name= "Memory (GB)";Expression={[math]::Round(($_.PhysicalMemory) / 1024)}},
    Processors, InstanceName,
    # total count of user dbs
    @{Name= "User DBs";Expression={($_.Databases | where {$_.Name -notin $systemDBs} | Measure).Count}},
    # total db size for all user dbs
    @{Name= "Total DB Size (GB)";Expression={[math]::Round(($_.Databases | where {$_.Name -notin $systemDBs} | Select size | Measure -Property Size -sum | Select sum).sum / 1024)}},
    # biggest DB (name, Size(GB)
    @{Name= "Biggest DB (GB)";Expression={"$($_.Databases | where {$_.Name -notin $systemDBs} | Sort Size -Descending | Select -ExpandProperty Name -First 1)
    ($([math]::Round(($_.Databases | where {$_.Name -notin $systemDBs} | Sort Size -Descending | Select -ExpandProperty Size -First 1)/1024)) GB)"}},
    # add the name of the Availability Group (if any)
    @{Name= "AG (s)";Expression={$_ | Select -ExpandProperty AvailabilityGroups | Select -ExpandProperty AvailabilityGroupListeners}},
    # add the current role of the server in the Availability Group (if any)
    @{Name= "Role (s)";Expression={$_ | Select -ExpandProperty AvailabilityGroups | Select -ExpandProperty LocalReplicaRole}}, ClusterName | Sort ComputerName</pre>
<p>While this code may look complex, from a PowerShell point of view it&rsquo;s really pretty simple. First, we take the list of our <code>Productionservers</code> and pipe it to <a href="https://docs.dbatools.io/#Connect-DbaInstance">Connect-DbaInstance</a> cmdlet. Connect-DbaInstance is the result of dbatools calling the SMO functionality, returning a complete SMO object of the SQL Server connected to.</p>
<p>Technically, the part with <code>$rawData = $ProductionServers | Connect-DbaInstance</code> already gives us all the information we need for our report. But since we don&rsquo;t want to return all the possible SMO properties and objects (that would result in a very long operation), we pipe the results of this directly to a Sort, followed by returning the actual information we are interested in:</p>
<pre class="lang:ps decode:true ">$rawData = $ProductionServers | Connect-DbaInstance | Sort Computername | Select ComputerName,</pre>
<p>First we extract the Computername. On the next two lines, we map the SQL Server major version number to a clear-text string:</p>
<pre class="lang:ps decode:true "># map the SQL version
@{Name="SQL Version";Expression={ if ($_.VersionMajor -eq "11") {"SQL 2012"} elseif ($_.VersionMajor -eq "12") {"SQL 2014"} elseif
($_.VersionMajor -eq "13") {"SQL 2016"} elseif ($_.VersionMajor -eq "14") {"SQL 2017"} elseif ($_.VersionMajor -eq "15") {"SQL 2019"}
elseif ($_.VersionMajor -lt "11") {"SQL 2008R2 or older"} else {"unknown"}}},</pre>
<p>Right on, we extract the product level (e.g. RTM, SP1, &hellip;) and the Edition of the SQL Server (Standard, Enterprise&hellip;), followed by the available machine memory.  Since this is returned in MB, we format and round it so that we get a nice number in GB (e.g. 12, 48 or 128).</p>
<p>Then we include the number of logical processors and the name of the instance &ndash; in case we have a named instance.</p>
<p>The number and size of user databases is a bit more complex. We need to query the &ldquo;Databases&rdquo; collection of the SMO Server object, filter out the system databases, get the size property of each object in the collection and measure it (count for the number and SUM for the combined size of the databases). Of course, we want those numbers to be nicely formatted and rounded to the full GB, so we add the formatting as well:</p>
<pre class="lang:ps decode:true "># total count of user dbs
@{Name= "User DBs";Expression={($_.Databases | Where {$_.Name -notin $systemDBs} | Measure).Count}},
# total db size for all user dbs
@{Name= "Total DB Size (GB)";Expression={[math]::Round(($_.Databases | Where {$_.Name -notin $systemDBs} | Select size | Measure
-Property Size -sum | Select sum).sum / 1024)}},</pre>
<p>To get the size of the biggest / largest database on the server, we use the same technique, only that we sort the database object list by size in descending order and take only the first object:</p>
<pre class="lang:ps decode:true "># biggest DB (name, Size(GB)
@{Name= "Biggest DB (GB)";Expression={"$($_.Databases | Where {$_.Name -notin $systemDBs} | Sort Size -Descending | Select -ExpandProperty Name -First 1)
($([math]::Round(($_.Databases | Where {$_.Name -notin $systemDBs} | Sort Size -Descending | Select -ExpandProperty Size -First 1)/1024)) GB)"}},</pre>
<p>The PowerShell pipeline can be really awesome!</p>
<p>Now  let&rsquo;s add the information about the Availability Group Listener to our list. The AG information is another sub-object of the SMO collection which we first have to extract to get to the information below.</p>
<pre class="lang:ps decode:true "># add the name of the Availability Group (if any)
@{Name= "AG (s)";Expression={$_ | Select -ExpandProperty AvailabilityGroups | Select -ExpandProperty AvailabilityGroupListeners}},</pre>
<p>And exactly the same way for the role of the current replica as well as the cluster object name:</p>
<pre class="lang:ps decode:true "># add the current role of the server in the Availability Group (if any)
@{Name= "Role (s)";Expression={$_ | Select -ExpandProperty AvailabilityGroups | Select -ExpandProperty LocalReplicaRole}}, ClusterName | Sort ComputerName</pre>
<p>That&rsquo;s a whole lot of information retrieved by just one call to a PowerShell method. How awesome is that? Most of our script is logic around formatting and extracting information from sub-properties and objects.</p>
<p>And finally, we add the Alias to our result, matching them by computername:</p>
<pre class="lang:ps decode:true "># add the alias to the rawdata
$rawData | % {
        $v = $_.ComputerName
        if ('' -ne $_.InstanceName){$v +="\$($_.InstanceName)"}
        $alias = $AliasList | Where {$_.Instance -eq $v } | Select -ExpandProperty Alias -First 1
        $_ | Add-Member -MemberType NoteProperty -Name AliasName -Value $alias
    }</pre>
<p>The last step is to convert our object to HTML and add some css styling to it. Then we can either send it via eMail or store the generated html as a file for future reference.</p>
<pre class="lang:ps decode:true ">$css = Get-Content (Join-Path $script:root -ChildPath 'css.txt')
$html = $rawData | ConvertTo-Html -Fragment -PreContent "$($css)&lt;h2&gt;Instance KPI Summary&lt;/h2&gt;" -PostContent "This summary has been generated with the help of the awesome PowerShell module dbatools!" | Out-File (Join-Path $script:root -ChildPath 'result.html')</pre>
<p>The result is a nicely formatted html report:<br>
<img src="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?fit=300%2C300&amp;ssl=1" alt="Picture 3: the result" class="alignnone size-medium wp-image-9599 jetpack-lazy-image" data-recalc-dims="1" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?w=2012&amp;ssl=1 2012w, https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?resize=300%2C60&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?resize=768%2C154&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?resize=1024%2C206&amp;ssl=1 1024w, https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?w=1600&amp;ssl=1 1600w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?fit=300%2C300&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img src="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?fit=300%2C300&amp;ssl=1" alt="Picture 3: the result" class="alignnone size-medium wp-image-9599" srcset="https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?w=2012&amp;ssl=1 2012w,https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?resize=300%2C60&amp;ssl=1 300w,https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?resize=768%2C154&amp;ssl=1 768w,https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?resize=1024%2C206&amp;ssl=1 1024w,https://dbatools.io/wp-content/uploads/2019/04/SQLInventory_results.png?w=1600&amp;ssl=1 1600w" sizes="(max-width: 800px) 100vw, 800px" data-recalc-dims="1"></noscript></p>
<p>This was only a very basic example of what you can do with PSTools, PowerShell and a bit of magic piping. I hope you found this useful.</p>
<p>For questions and remarks please feel free to <a href="http://www.linkedin.com/in/schubertandreas">message me</a> at any time!</p>
<p>You can find the complete script in my <a href="https://github.com/AndreasESchubert/Automation/blob/master/Inventory_Basic.ps1" rel="noopener" target="_blank">GitHub repo</a>.</p>

<div id="jp-relatedposts" class="jp-relatedposts">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>			</div>

	<footer class="entry-footer">
			</footer>
</article>


					
<div id="comments" class="comments-area">

	
			<h3 class="comments-title">
			40 thoughts on &ldquo;<span>building an inventory view of SQL Servers with dbatools</span>&rdquo;		</h3>

		
		<ol class="comment-list">
			    <li class="comment even thread-even depth-1" id="li-comment-63975">
        <article id="comment-63975" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="https://marcin.gminski.net" rel="external nofollow ugc" class="url">Marcin Gminski</a></b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63975"><time datetime="2019-04-25T11:24:30+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=63975#respond" data-commentid="63975" data-postid="9595" data-belowelement="comment-63975" data-respondelement="respond" aria-label="Reply to Marcin Gminski">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Good job. This subject is close to my heart! You will be pleased to know that we&rsquo;re actually building an inventory command into dbatools. Feel free to contribute!</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor odd alt depth-2" id="li-comment-63988">
        <article id="comment-63988" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63988"><time datetime="2019-04-25T13:41:25+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=63988#respond" data-commentid="63988" data-postid="9595" data-belowelement="comment-63988" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Thank you Marcin,  i will get in touch with you on this</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
    <li class="comment even thread-odd thread-alt depth-1" id="li-comment-63981">
        <article id="comment-63981" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/75611544f22ed52c584653cffc09ccf2?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/75611544f22ed52c584653cffc09ccf2?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/75611544f22ed52c584653cffc09ccf2?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/75611544f22ed52c584653cffc09ccf2?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/75611544f22ed52c584653cffc09ccf2?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Ewan Campbell</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63981"><time datetime="2019-04-25T12:31:57+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=63981#respond" data-commentid="63981" data-postid="9595" data-belowelement="comment-63981" data-respondelement="respond" aria-label="Reply to Ewan Campbell">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Thanks. Useful.<br>
When you have a list of SQL Servers to query, very good.<br>
What about a situation where no-one has a SQL server list?<br>
eg. you inherit a SQL estate that isn&rsquo;t documented properly.<br>
So you want to discover what&rsquo;s out there.</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor odd alt depth-2" id="li-comment-63987">
        <article id="comment-63987" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63987"><time datetime="2019-04-25T13:40:35+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=63987#respond" data-commentid="63987" data-postid="9595" data-belowelement="comment-63987" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Ewan, in this case you have the perfect opportunity to get to know the network team.  Grab a bunch of coffee cups, visit them and discuss the options around scanning the network for SQL Instances. You want to ask them first because once you start scanning, all sorts of intrusion alerts will go off when the network is properly monitored. There&rsquo;s a so a dbatools command for help with finding instances, so once you start you will be amazed how many &lsquo;unknown and unmanaged&rsquo; SQLs you will find, even in environments that are considered well documented &#128521;</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment even depth-2" id="li-comment-63992">
        <article id="comment-63992" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="https://marcin.gminski.net" rel="external nofollow ugc" class="url">Marcin Gminski</a></b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63992"><time datetime="2019-04-25T14:18:30+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=63992#respond" data-commentid="63992" data-postid="9595" data-belowelement="comment-63992" data-respondelement="respond" aria-label="Reply to Marcin Gminski">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>A combination of nmap scanner and then WMI discovery to get available instances did the trick. I&rsquo;m hoping we can build similar discoverer in dbatools at some point.</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor odd alt depth-3" id="li-comment-63995">
        <article id="comment-63995" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63995"><time datetime="2019-04-25T15:39:13+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=63995#respond" data-commentid="63995" data-postid="9595" data-belowelement="comment-63995" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Marcin, sure, that&rsquo;s a valid and common option. Though I find the usage of nmap raises far too many security concerns in corporate environments so that I try not to use it there.<br>
I tested &ldquo;Find-DbaInstance -DiscoveryType Domain, DataSourceEnumeration&rdquo; and found it to be good enough for a quick inventory. Sure, it doesn&rsquo;t find those instances that don&rsquo;t have SQL Browser enabled, but those can be found easily by doing a quick broadcast to 1433 and 1434 &#128521;</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment even depth-4" id="li-comment-63996">
        <article id="comment-63996" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="https://marcin.gminski.net" rel="external nofollow ugc" class="url">Marcin Gminski</a></b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63996"><time datetime="2019-04-25T15:49:50+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=63996#respond" data-commentid="63996" data-postid="9595" data-belowelement="comment-63996" data-respondelement="respond" aria-label="Reply to Marcin Gminski">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Absolutely, it was just an example of how I dealt with it on 17k+ servers estate.</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor odd alt depth-5" id="li-comment-63997">
        <article id="comment-63997" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63997"><time datetime="2019-04-25T15:55:18+00:00">April 25, 2019</time></a>                </header>

                
                <div class="comment-content entry-content">
                    <p>And was the number of unknown / unmanaged / unsecured SQL 2 or 3 digits?</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment even depth-5" id="li-comment-63998">
        <article id="comment-63998" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="https://marcin.gminski.net" rel="external nofollow ugc" class="url">Marcin Gminski</a></b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63998"><time datetime="2019-04-25T15:57:43+00:00">April 25, 2019</time></a>                </header>

                
                <div class="comment-content entry-content">
                    <p>It was for license audit and definitely more than we would have liked &#128578;</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment odd alt depth-5" id="li-comment-63999">
        <article id="comment-63999" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1c667ece81cd1286bffd4897918a66f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="https://marcin.gminski.net" rel="external nofollow ugc" class="url">Marcin Gminski</a></b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63999"><time datetime="2019-04-25T16:01:42+00:00">April 25, 2019</time></a>                </header>

                
                <div class="comment-content entry-content">
                    <p>The benefit and the main reason for nmap was the performance. Nothing compared to it. </p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment byuser comment-author-andreas bypostauthor even depth-5" id="li-comment-64001">
        <article id="comment-64001" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-64001"><time datetime="2019-04-25T16:09:04+00:00">April 25, 2019</time></a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Totally agree! Nmap is a tool every DBA should know how to use</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
    <li class="comment odd alt thread-even depth-1" id="li-comment-63989">
        <article id="comment-63989" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/a2f601b7a0fabf67b0caa008f9d93988?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/a2f601b7a0fabf67b0caa008f9d93988?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/a2f601b7a0fabf67b0caa008f9d93988?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/a2f601b7a0fabf67b0caa008f9d93988?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a2f601b7a0fabf67b0caa008f9d93988?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://fleitasarts.com" rel="external nofollow ugc" class="url">Hiram Fleitas</a></b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63989"><time datetime="2019-04-25T13:41:58+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=63989#respond" data-commentid="63989" data-postid="9595" data-belowelement="comment-63989" data-respondelement="respond" aria-label="Reply to Hiram Fleitas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>This is awesome! Thx</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment even thread-odd thread-alt depth-1" id="li-comment-63991">
        <article id="comment-63991" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7c19184cbdafb7126c8e9971c1084b6b?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7c19184cbdafb7126c8e9971c1084b6b?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7c19184cbdafb7126c8e9971c1084b6b?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7c19184cbdafb7126c8e9971c1084b6b?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c19184cbdafb7126c8e9971c1084b6b?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Yuri</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-63991"><time datetime="2019-04-25T14:08:56+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=63991#respond" data-commentid="63991" data-postid="9595" data-belowelement="comment-63991" data-respondelement="respond" aria-label="Reply to Yuri">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Thank you! Very useful! Could you share the css file please?</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment odd alt thread-even depth-1" id="li-comment-64000">
        <article id="comment-64000" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/12b7cd02ebf4c134ddb1020bd5bc1b20?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/12b7cd02ebf4c134ddb1020bd5bc1b20?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/12b7cd02ebf4c134ddb1020bd5bc1b20?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/12b7cd02ebf4c134ddb1020bd5bc1b20?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/12b7cd02ebf4c134ddb1020bd5bc1b20?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">wondi</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-64000"><time datetime="2019-04-25T16:06:07+00:00">April 25, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=64000#respond" data-commentid="64000" data-postid="9595" data-belowelement="comment-64000" data-respondelement="respond" aria-label="Reply to wondi">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>awesome</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment even thread-odd thread-alt depth-1" id="li-comment-64049">
        <article id="comment-64049" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/5b0ba7dc150bf3a5816d882d18d19273?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/5b0ba7dc150bf3a5816d882d18d19273?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/5b0ba7dc150bf3a5816d882d18d19273?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/5b0ba7dc150bf3a5816d882d18d19273?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5b0ba7dc150bf3a5816d882d18d19273?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://linkedin.com/in/stuartmccolvin" rel="external nofollow ugc" class="url">St0zM4c</a></b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-64049"><time datetime="2019-04-26T13:39:20+00:00">April 26, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=64049#respond" data-commentid="64049" data-postid="9595" data-belowelement="comment-64049" data-respondelement="respond" aria-label="Reply to St0zM4c">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Thank you! I like it indeed very useful! Could you please share the css file?</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor odd alt depth-2" id="li-comment-64152">
        <article id="comment-64152" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-64152"><time datetime="2019-04-27T18:53:00+00:00">April 27, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=64152#respond" data-commentid="64152" data-postid="9595" data-belowelement="comment-64152" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Hey, thanks everyone for your interest! A simplified version of the css that you can customize has been uploaded to the GitHub repository.</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
    <li class="comment even thread-even depth-1" id="li-comment-64208">
        <article id="comment-64208" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7a047a8a78c7da0d6ac6cb10fa05ba5a?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7a047a8a78c7da0d6ac6cb10fa05ba5a?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7a047a8a78c7da0d6ac6cb10fa05ba5a?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7a047a8a78c7da0d6ac6cb10fa05ba5a?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7a047a8a78c7da0d6ac6cb10fa05ba5a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">AUGUST SPIER</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-64208"><time datetime="2019-04-28T11:40:16+00:00">April 28, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=64208#respond" data-commentid="64208" data-postid="9595" data-belowelement="comment-64208" data-respondelement="respond" aria-label="Reply to AUGUST SPIER">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>I inherited a complicated, undisciplined implementation SQL Server. I found Active Directory to be helpful enumerating SQL Server names. Try:</p>
<p>$servers = Get-ADComputer -Filter  -SearchBase &hellip;</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-64350">
        <article id="comment-64350" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Guenter</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-64350"><time datetime="2019-04-30T11:11:49+00:00">April 30, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=64350#respond" data-commentid="64350" data-postid="9595" data-belowelement="comment-64350" data-respondelement="respond" aria-label="Reply to Guenter">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Great Script!</p>
<p>Would be even more useful to us, if the Build Number could be included. Like 13.0.5026.0</p>
<p>Best regards</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor even depth-2" id="li-comment-64352">
        <article id="comment-64352" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-64352"><time datetime="2019-04-30T11:19:02+00:00">April 30, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=64352#respond" data-commentid="64352" data-postid="9595" data-belowelement="comment-64352" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Guenter, the build number can be easily included:<br>
connect-dbaInstance YourInstance | Select ComputerName, BuildNumber, VersionString</p>
<p>if you just need the build number, use the property &ldquo;BuildNumber&rdquo;. If you want the full version number, use property &ldquo;VersionString&rdquo;.<br>
and then include it in your output &#128578;</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
    <li class="comment odd alt thread-even depth-1" id="li-comment-64353">
        <article id="comment-64353" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0458709f7c1c74c668109b49d92a183b?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Guenter</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-64353"><time datetime="2019-04-30T11:39:38+00:00">April 30, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=64353#respond" data-commentid="64353" data-postid="9595" data-belowelement="comment-64353" data-respondelement="respond" aria-label="Reply to Guenter">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Andreas, I just added it to your existing configuration: &hellip;VersionString, ProductLevel, Edition,&hellip;</p>
<p>Works as expected, thanks a lot for your quick response!</p>
<p>SQL Version VersionString ProductLevel<br>
SQL 2017     14.0.3035.2     RTM</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment even thread-odd thread-alt depth-1" id="li-comment-64520">
        <article id="comment-64520" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/e8cff3fa6de06eb3fe94d7ea5bdbec16?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/e8cff3fa6de06eb3fe94d7ea5bdbec16?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/e8cff3fa6de06eb3fe94d7ea5bdbec16?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/e8cff3fa6de06eb3fe94d7ea5bdbec16?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e8cff3fa6de06eb3fe94d7ea5bdbec16?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Greg</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-64520"><time datetime="2019-05-02T11:54:46+00:00">May 2, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=64520#respond" data-commentid="64520" data-postid="9595" data-belowelement="comment-64520" data-respondelement="respond" aria-label="Reply to Greg">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Hello All,<br>
I didn&rsquo;t use a Server List (Txt File). As I had a direct access to the SCCM Database of our company, I used it to list all the Server hosting a SQL Server Instance (filtering on the Express Editions as those are not managed by the DBA Team).<br>
Obviously to have the SQL Server inventory in SCCM you need to implement it on your SCCM Server (<a href="https://sccm-zone.com/sql-version-detection-and-report-sccm-2012-r2-12f299b5e63b" rel="nofollow ugc">https://sccm-zone.com/sql-version-detection-and-report-sccm-2012-r2-12f299b5e63b</a>).<br>
Then you can build the query easily to retrieve only the Server List.</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment odd alt thread-even depth-1" id="li-comment-65742">
        <article id="comment-65742" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/e740f124fddde4bbb4435291f1e70426?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/e740f124fddde4bbb4435291f1e70426?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/e740f124fddde4bbb4435291f1e70426?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/e740f124fddde4bbb4435291f1e70426?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e740f124fddde4bbb4435291f1e70426?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Raj</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-65742"><time datetime="2019-05-19T04:58:04+00:00">May 19, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=65742#respond" data-commentid="65742" data-postid="9595" data-belowelement="comment-65742" data-respondelement="respond" aria-label="Reply to Raj">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Awesome and thank you for the neat explanation,  I going to give it a try at my current work and post here when I done.</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment even thread-odd thread-alt depth-1" id="li-comment-66940">
        <article id="comment-66940" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/885b6b25452a5f407e72d044c21575e9?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/885b6b25452a5f407e72d044c21575e9?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/885b6b25452a5f407e72d044c21575e9?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/885b6b25452a5f407e72d044c21575e9?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/885b6b25452a5f407e72d044c21575e9?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">james</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-66940"><time datetime="2019-06-12T21:53:15+00:00">June 12, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=66940#respond" data-commentid="66940" data-postid="9595" data-belowelement="comment-66940" data-respondelement="respond" aria-label="Reply to james">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Thanks  for this awesome script.</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor odd alt depth-2" id="li-comment-66962">
        <article id="comment-66962" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-66962"><time datetime="2019-06-13T08:27:53+00:00">June 13, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=66962#respond" data-commentid="66962" data-postid="9595" data-belowelement="comment-66962" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Thanks James, glad you find it useful</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
    <li class="comment even thread-even depth-1" id="li-comment-67222">
        <article id="comment-67222" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">David Waller</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-67222"><time datetime="2019-06-18T19:12:56+00:00">June 18, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=67222#respond" data-commentid="67222" data-postid="9595" data-belowelement="comment-67222" data-respondelement="respond" aria-label="Reply to David Waller">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>I am trying this out and got it working. I am having an issue with the CSS.txt file. Did you all ready have one or do we create our own?</p>
<p>Thanks</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor odd alt depth-2" id="li-comment-67223">
        <article id="comment-67223" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-67223"><time datetime="2019-06-18T19:15:33+00:00">June 18, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=67223#respond" data-commentid="67223" data-postid="9595" data-belowelement="comment-67223" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>David, the link to github contains a very simple css. Feel free to adapt it to your own liking. The focus of the post was on how to get the data, not on design &#128521;</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment even depth-3" id="li-comment-67224">
        <article id="comment-67224" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">David Waller</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-67224"><time datetime="2019-06-18T19:26:23+00:00">June 18, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=67224#respond" data-commentid="67224" data-postid="9595" data-belowelement="comment-67224" data-respondelement="respond" aria-label="Reply to David Waller">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Thanks for the quick reply&hellip;.</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
</ul>
</li>
    <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-67226">
        <article id="comment-67226" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/afb95a64a4ff07dccb3f8dc3dc579bff?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">David Waller</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-67226"><time datetime="2019-06-18T20:19:31+00:00">June 18, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=67226#respond" data-commentid="67226" data-postid="9595" data-belowelement="comment-67226" data-respondelement="respond" aria-label="Reply to David Waller">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>How would you send this in an email? I could setup a job to run it.</p>
<p>Thanks</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment even thread-even depth-1" id="li-comment-68079">
        <article id="comment-68079" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/8232d8f061c7579d3fe9ba2fdcbff48c?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/8232d8f061c7579d3fe9ba2fdcbff48c?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/8232d8f061c7579d3fe9ba2fdcbff48c?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/8232d8f061c7579d3fe9ba2fdcbff48c?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8232d8f061c7579d3fe9ba2fdcbff48c?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Jan Debonnet</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-68079"><time datetime="2019-07-03T12:39:45+00:00">July 3, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=68079#respond" data-commentid="68079" data-postid="9595" data-belowelement="comment-68079" data-respondelement="respond" aria-label="Reply to Jan Debonnet">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Thank you, this was very useful. I just changed the html/css to this &lsquo;Out-HtmlView&rsquo; which I think is very useful: <a href="https://evotec.xyz/out-htmlview-html-alternative-to-out-gridview/" rel="nofollow ugc">https://evotec.xyz/out-htmlview-html-alternative-to-out-gridview/</a></p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-73056">
        <article id="comment-73056" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://eslsql.wordpress.com" rel="external nofollow ugc" class="url">Eric</a></b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-73056"><time datetime="2019-09-03T12:22:36+00:00">September 3, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=73056#respond" data-commentid="73056" data-postid="9595" data-belowelement="comment-73056" data-respondelement="respond" aria-label="Reply to Eric">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Very helpfull,<br>
could i have an example of your css.txt file, i don&rsquo;t know css&hellip;</p>
<p>best regards</p>
<p>Eric</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor even depth-2" id="li-comment-73286">
        <article id="comment-73286" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-73286"><time datetime="2019-09-05T09:14:37+00:00">September 5, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=73286#respond" data-commentid="73286" data-postid="9595" data-belowelement="comment-73286" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Eric, if you follow the link to the GitHub repo at the end of the article, you will find a default css file</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment odd alt depth-3" id="li-comment-73288">
        <article id="comment-73288" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/533a0c1ace1f8a098870550bee6368d7?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Eric</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-73288"><time datetime="2019-09-05T09:25:54+00:00">September 5, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=73288#respond" data-commentid="73288" data-postid="9595" data-belowelement="comment-73288" data-respondelement="respond" aria-label="Reply to Eric">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>great thanks, i need to change my glasses by a loope &#128521;</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
</ul>
</li>
    <li class="comment even thread-even depth-1" id="li-comment-77657">
        <article id="comment-77657" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/fe039477bad0fc285baea834b37e75a2?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/fe039477bad0fc285baea834b37e75a2?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/fe039477bad0fc285baea834b37e75a2?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/fe039477bad0fc285baea834b37e75a2?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fe039477bad0fc285baea834b37e75a2?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">BK</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-77657"><time datetime="2019-12-11T04:41:04+00:00">December 11, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=77657#respond" data-commentid="77657" data-postid="9595" data-belowelement="comment-77657" data-respondelement="respond" aria-label="Reply to BK">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Hi Eric, Thank you for providing such great stuff. Can we insert the data into SQL table and then send a email to DBA team .</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor odd alt depth-2" id="li-comment-77809">
        <article id="comment-77809" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-77809"><time datetime="2019-12-16T09:08:03+00:00">December 16, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=77809#respond" data-commentid="77809" data-postid="9595" data-belowelement="comment-77809" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>BK, yes. Absolutely</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
    <li class="comment even thread-odd thread-alt depth-1" id="li-comment-78098">
        <article id="comment-78098" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Cor Perlee</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-78098"><time datetime="2019-12-24T13:41:15+00:00">December 24, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=78098#respond" data-commentid="78098" data-postid="9595" data-belowelement="comment-78098" data-respondelement="respond" aria-label="Reply to Cor Perlee">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Hi Andreas</p>
<p>Love your script!<br>
Is there a way to get the clustername and Roles of &lsquo; normal&rsquo; SQL clusters in stead of just AG&rsquo;s?</p>
<p>Best regards,</p>
<p>Cor Perlee</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-andreas bypostauthor odd alt depth-2" id="li-comment-78099">
        <article id="comment-78099" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7add77da09816012f34497c500c78062?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.linkedin.com/in/schubertandreas" rel="external nofollow ugc" class="url">Andreas</a></b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-78099"><time datetime="2019-12-24T13:45:46+00:00">December 24, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=78099#respond" data-commentid="78099" data-postid="9595" data-belowelement="comment-78099" data-respondelement="respond" aria-label="Reply to Andreas">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Hi Cor, </p>
<p>thanks and a Merry Christmas to you!<br>
Sure there is. Start with the Get-DbaWsfcCluster and Get-DbaWsfcRole commands, they will give you most of what you need.<br>
Best regards<br>
Andreas</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
    <li class="comment even thread-even depth-1" id="li-comment-78397">
        <article id="comment-78397" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Cor Perlee</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-78397"><time datetime="2020-01-02T07:36:01+00:00">January 2, 2020</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=78397#respond" data-commentid="78397" data-postid="9595" data-belowelement="comment-78397" data-respondelement="respond" aria-label="Reply to Cor Perlee">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Thanks Andreas!</p>
<p>Happy New Year!</p>
<p>Best regards,</p>
<p>Cor</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-78403">
        <article id="comment-78403" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf8fe6783f0e28f99c3e42cc0a0033f2?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Cor Perlee</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-78403"><time datetime="2020-01-02T10:46:28+00:00">January 2, 2020</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=78403#respond" data-commentid="78403" data-postid="9595" data-belowelement="comment-78403" data-respondelement="respond" aria-label="Reply to Cor Perlee">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Hi Andreas,</p>
<p>I am trying to incorporate the Get-DbaWsfcRole command in the script but having no succes.<br>
Could you provide an example of this?</p>
<p>Best regards,</p>
<p>Cor Perlee</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment even thread-even depth-1" id="li-comment-79388">
        <article id="comment-79388" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/ac9f2a4142dc242b8579d2c4ae6dbf5d?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/ac9f2a4142dc242b8579d2c4ae6dbf5d?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/ac9f2a4142dc242b8579d2c4ae6dbf5d?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/ac9f2a4142dc242b8579d2c4ae6dbf5d?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ac9f2a4142dc242b8579d2c4ae6dbf5d?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn"><a href="http://www.kronva.com" rel="external nofollow ugc" class="url">garrett devine</a></b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-79388"><time datetime="2020-01-30T00:02:35+00:00">January 30, 2020</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=79388#respond" data-commentid="79388" data-postid="9595" data-belowelement="comment-79388" data-respondelement="respond" aria-label="Reply to garrett devine">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>is it possible to write this using sql authentication?  I tried this</p>
<p>$Credential = Get-Credential sa<br>
&hellip;.<br>
$rawData = $ServerList | Connect-DbaInstance -SqlCredential $Credential</p>
<p> but it does not like the &ldquo;-SqlCredential $Credential&rdquo; part</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-79667">
        <article id="comment-79667" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/e15231d285cd5780984da9664005ad32?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/e15231d285cd5780984da9664005ad32?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/e15231d285cd5780984da9664005ad32?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/e15231d285cd5780984da9664005ad32?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e15231d285cd5780984da9664005ad32?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Al</b> </cite><a class="comment-time" href="https://dbatools.io/building-an-inventory/#comment-79667"><time datetime="2020-03-11T18:43:31+00:00">March 11, 2020</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/building-an-inventory/?replytocom=79667#respond" data-commentid="79667" data-postid="9595" data-belowelement="comment-79667" data-respondelement="respond" aria-label="Reply to Al">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Hi Andreas,</p>
<p>Very nice script, is it possible to add disk capacity information?</p>
                                    </div>

            </div>

        </article>
    </li>
		</ol>

		
	
	
	
		<div id="respond" class="comment-respond">
							<h3 id="reply-title" class="comment-reply-title">Leave a Reply					<small><a rel="nofollow" id="cancel-comment-reply-link" href="https://dbatools.io/building-an-inventory/#respond" style="display:none;">Cancel reply</a></small>
				</h3>
						<form id="commentform" class="comment-form">
				<iframe title="Comment Form" src="https://jetpack.wordpress.com/jetpack-comment/?blogid=111052036&amp;postid=9595&amp;comment_registration=0&amp;require_name_email=1&amp;stc_enabled=1&amp;stb_enabled=1&amp;show_avatars=1&amp;avatar_default=mystery&amp;greeting=Leave+a+Reply&amp;greeting_reply=Leave+a+Reply+to+%25s&amp;color_scheme=light&amp;lang=en_US&amp;jetpack_version=8.4.2&amp;show_cookie_consent=10&amp;has_cookie_consent=0&amp;token_key=%3Bnormal%3B&amp;sig=99b4982af70e2dde672e3959bf1c7603186ee98a#parent=https%3A%2F%2Fdbatools.io%2Fbuilding-an-inventory%2F" style="width:100%; height: 430px; border:0;" name="jetpack_remote_comment" class="jetpack_remote_comment" id="jetpack_remote_comment" sandbox="allow-same-origin allow-top-navigation allow-scripts allow-forms allow-popups"></iframe>
									
					<script>
						document.addEventListener('DOMContentLoaded', function () {
							var commentForms = document.getElementsByClassName('jetpack_remote_comment');
							for (var i = 0; i < commentForms.length; i++) {
								commentForms[i].allowTransparency = false;
								commentForms[i].scrolling = 'no';
							}
						});
					</script>
					
							</form>
		</div>

		
		<input type="hidden" name="comment_parent" id="comment_parent" value="">

		<p class="akismet_comment_form_privacy_notice">This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" target="_blank" rel="nofollow noopener">Learn how your comment data is processed</a>.</p>
</div>

				
				</main>
			</div>

                            
<div id="secondary" class="widget-area sidebar" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://dbatools.io/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="Search">
			</form></aside><aside id="custom_html-3" class="widget_text widget widget_custom_html"><h2 class="widget-title">new book</h2><div class="textwidget custom-html-widget">dbatools in a month of lunches is now available in Manning's Early Access Program &#128640; <br>&nbsp;

<p align="center"><a href="https://dbatools.io/book"><img alt="dbatools meap" src="https://i2.wp.com/blog.netnerds.net/wp-content/uploads/2019/08/meap.png?w=800&amp;ssl=1" data-recalc-dims="1" data-lazy-src="https://i2.wp.com/blog.netnerds.net/wp-content/uploads/2019/08/meap.png?w=800&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " class=" jetpack-lazy-image"><noscript><img alt="dbatools meap" src="https://i2.wp.com/blog.netnerds.net/wp-content/uploads/2019/08/meap.png?w=800&amp;ssl=1" data-recalc-dims="1"></noscript></a></p>

Get the book now at <a href="https://dbatools.io/book">manning.com</a></div></aside><aside id="sticky-posts-2" class="widget widget_ultimate_posts"><h2 class="widget-title"><a href="https://dbatools.io/blog">posts</a></h2>

<div class="upw-posts hfeed">

  
      
        
        <article class="post-10008 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/aliases/" rel="bookmark">
                  <img width="300" height="155" src="https://i2.wp.com/dbatools.io/wp-content/uploads/2020/01/cli12a.png?fit=300%2C155&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://i2.wp.com/dbatools.io/wp-content/uploads/2020/01/cli12a.png?w=905&amp;ssl=1 905w, https://i2.wp.com/dbatools.io/wp-content/uploads/2020/01/cli12a.png?resize=300%2C155&amp;ssl=1 300w, https://i2.wp.com/dbatools.io/wp-content/uploads/2020/01/cli12a.png?resize=768%2C396&amp;ssl=1 768w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://i2.wp.com/dbatools.io/wp-content/uploads/2020/01/cli12a.png?fit=300%2C155&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/aliases/" rel="bookmark">
                  working with sql client aliases                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-10124 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/bits2020/" rel="bookmark">
                  <img width="300" height="108" src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/bits2020/" rel="bookmark">
                  Vote for these SQLBits 2020 PowerShell sessions                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-10010 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/size/" rel="bookmark">
                  <img width="300" height="139" src="https://i2.wp.com/dbatools.io/wp-content/uploads/2019/09/disksize.png?fit=300%2C139&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://i2.wp.com/dbatools.io/wp-content/uploads/2019/09/disksize.png?w=1139&amp;ssl=1 1139w, https://i2.wp.com/dbatools.io/wp-content/uploads/2019/09/disksize.png?resize=300%2C139&amp;ssl=1 300w, https://i2.wp.com/dbatools.io/wp-content/uploads/2019/09/disksize.png?resize=768%2C355&amp;ssl=1 768w, https://i2.wp.com/dbatools.io/wp-content/uploads/2019/09/disksize.png?resize=1024%2C473&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://i2.wp.com/dbatools.io/wp-content/uploads/2019/09/disksize.png?fit=300%2C139&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/size/" rel="bookmark">
                  working with file sizes in dbatools                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-9995 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements tag-book tag-dbatoolsmol tag-monthoflunches">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/meap/" rel="bookmark">
                  <img width="300" height="159" src="https://i0.wp.com/dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?fit=300%2C159&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://i0.wp.com/dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?w=1287&amp;ssl=1 1287w, https://i0.wp.com/dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?resize=300%2C159&amp;ssl=1 300w, https://i0.wp.com/dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?resize=768%2C408&amp;ssl=1 768w, https://i0.wp.com/dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?resize=1024%2C543&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://i0.wp.com/dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?fit=300%2C159&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/meap/" rel="bookmark">
                  Learn dbatools in a Month of Lunches                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-9928 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/oldapp/" rel="bookmark">
                  <img width="300" height="108" src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/oldapp/" rel="bookmark">
                  migrating super old app databases                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-9862 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements tag-dbatools-configs tag-dbatools-settings tag-defaults">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/configuration/" rel="bookmark">
                  <img width="300" height="202" src="https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?fit=300%2C202&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?w=1104&amp;ssl=1 1104w, https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?resize=300%2C202&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?resize=768%2C516&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?resize=1024%2C688&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?fit=300%2C202&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/configuration/" rel="bookmark">
                  dbatools advanced configuration                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
  
</div>

</aside><aside id="blog_subscription-2" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title">subscribe</h2>
            <form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
				                    <div id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
</div><p>Join 2,166 other subscribers</p>
                    <p id="subscribe-email">
                        <label id="jetpack-subscribe-label" class="screen-reader-text" for="subscribe-field-blog_subscription-2">
							email                        </label>
                        <input type="email" name="email" required="required" class="required" value="" id="subscribe-field-blog_subscription-2" placeholder="email">
                    </p>

                    <p id="subscribe-submit">
                        <input type="hidden" name="action" value="subscribe">
                        <input type="hidden" name="source" value="https://dbatools.io/building-an-inventory/">
                        <input type="hidden" name="sub-type" value="widget">
                        <input type="hidden" name="redirect_fragment" value="blog_subscription-2">
						                        <button type="submit" name="jetpack_subscriptions_widget">
	                        subscribe                        </button>
                    </p>
				            </form>
		
</aside><aside id="eu_cookie_law_widget-3" class="widget widget_eu_cookie_law_widget"><div class="hide-on-button" data-hide-timeout="30" data-consent-expiration="180" id="eu-cookie-law">
	<form method="post">
		<input type="submit" value="Close and accept" class="accept">
	</form>

	Privacy &amp; Cookies: This site uses cookies. By continuing to use this website, you agree to their use. <br>
To find out more, including how to control cookies, see here:
	<a href="https://automattic.com/cookies/">
		Cookie Policy	</a>
</div>
</aside></div>
            
		</div>
	</div>

    <footer id="colophon" class="site-footer" role="contentinfo">
                    <div class="footer-connect">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-2"></div>
                        
                        <div class="col-sm-8">
                                                            <div class="footer-social">
                                    <h5 class="follow-heading">dbatools on the web</h5><div class="footer-social-icons"><a target="_blank" href="http://git.io/b3oo" title="github"><i class="fa fa-github"></i></a><a target="_blank" href="https://www.youtube.com/channel/UC1qrq0zfswSM_Uf9-vBrsiw" title="YouTube"><i class="fa fa-youtube"></i></a><a target="_blank" href="https://dbatools.io/slack" title="Slack"><i class="fa fa-slack"></i></a><a target="_blank" href="https://twitter.com/psdbatools" title="Twitter"><i class="fa fa-twitter"></i></a><a target="_blank" href="https://www.linkedin.com/company/dbatools.io" title="LinkedIn"><i class="fa fa-linkedin-square fa-linkedin"></i></a><a target="_blank" href="https://twitch.tv/dbatools" title="Twitch"><i class="fa fa-twitch"></i></a><a target="_blank" href="https://dbatools.io/book" title="Manning"><i class="fa fa-book fa-manning"></i></a></div>                                </div>
                                                    </div>
                        <div class="col-sm-2"></div>
                    </div>
                </div>
            </div>
        
        <div class="site-info">
            <div class="container">
                                &copy; 2020 Chrissy LeMaire, PowerShell and SQL Server MVP<br><a href="https://dbatools.io/contact">Contact Us</a>            </div>
        </div>
        

    </footer>
</div>

	<div style="display:none">
	<div class="grofile-hash-map-a1c667ece81cd1286bffd4897918a66f">
	</div>
	<div class="grofile-hash-map-7add77da09816012f34497c500c78062">
	</div>
	<div class="grofile-hash-map-75611544f22ed52c584653cffc09ccf2">
	</div>
	<div class="grofile-hash-map-a2f601b7a0fabf67b0caa008f9d93988">
	</div>
	<div class="grofile-hash-map-7c19184cbdafb7126c8e9971c1084b6b">
	</div>
	<div class="grofile-hash-map-12b7cd02ebf4c134ddb1020bd5bc1b20">
	</div>
	<div class="grofile-hash-map-629eae884a81125413fd7c4d1943053b">
	</div>
	<div class="grofile-hash-map-7a047a8a78c7da0d6ac6cb10fa05ba5a">
	</div>
	<div class="grofile-hash-map-0458709f7c1c74c668109b49d92a183b">
	</div>
	<div class="grofile-hash-map-e8cff3fa6de06eb3fe94d7ea5bdbec16">
	</div>
	<div class="grofile-hash-map-e740f124fddde4bbb4435291f1e70426">
	</div>
	<div class="grofile-hash-map-885b6b25452a5f407e72d044c21575e9">
	</div>
	<div class="grofile-hash-map-afb95a64a4ff07dccb3f8dc3dc579bff">
	</div>
	<div class="grofile-hash-map-8232d8f061c7579d3fe9ba2fdcbff48c">
	</div>
	<div class="grofile-hash-map-533a0c1ace1f8a098870550bee6368d7">
	</div>
	<div class="grofile-hash-map-fe039477bad0fc285baea834b37e75a2">
	</div>
	<div class="grofile-hash-map-cf8fe6783f0e28f99c3e42cc0a0033f2">
	</div>
	<div class="grofile-hash-map-ac9f2a4142dc242b8579d2c4ae6dbf5d">
	</div>
	<div class="grofile-hash-map-e15231d285cd5780984da9664005ad32">
	</div>
	</div>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/photon/photon.min.js"></script>
<script type="text/javascript" src="https://secure.gravatar.com/js/gprofiles.js?ver=202035"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/modules/wpgroho.js"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/plugins.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/bootstrap.min.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/lightgallery.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/theme.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/widgets/eu-cookie-law/eu-cookie-law.min.js"></script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/lazy-images/js/lazy-images.min.js"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/plugins/onepress-plus/assets/js/onepress-plus.js?ver=10.1.8"></script>
<script async="async" type="text/javascript" src="https://dbatools.io/wp-content/plugins/akismet/_inc/form.js?ver=4.1.4"></script>

		
		<script type="text/javascript">
			(function () {
				var comm_par_el = document.getElementById( 'comment_parent' ),
					comm_par = ( comm_par_el && comm_par_el.value ) ? comm_par_el.value : '',
					frame = document.getElementById( 'jetpack_remote_comment' ),
					tellFrameNewParent;

				tellFrameNewParent = function () {
					if ( comm_par ) {
						frame.src = "https://jetpack.wordpress.com/jetpack-comment/?blogid=111052036&postid=9595&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=1&avatar_default=mystery&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=8.4.2&show_cookie_consent=10&has_cookie_consent=0&token_key=%3Bnormal%3B&sig=99b4982af70e2dde672e3959bf1c7603186ee98a#parent=https%3A%2F%2Fdbatools.io%2Fbuilding-an-inventory%2F" + '&replytocom=' + parseInt( comm_par, 10 ).toString();
					} else {
						frame.src = "https://jetpack.wordpress.com/jetpack-comment/?blogid=111052036&postid=9595&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=1&avatar_default=mystery&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=8.4.2&show_cookie_consent=10&has_cookie_consent=0&token_key=%3Bnormal%3B&sig=99b4982af70e2dde672e3959bf1c7603186ee98a#parent=https%3A%2F%2Fdbatools.io%2Fbuilding-an-inventory%2F";
					}
				};

				
				if ( 'undefined' !== typeof addComment ) {
					addComment._Jetpack_moveForm = addComment.moveForm;

					addComment.moveForm = function ( commId, parentId, respondId, postId ) {
						var returnValue = addComment._Jetpack_moveForm( commId, parentId, respondId, postId ),
							cancelClick, cancel;

						if ( false === returnValue ) {
							cancel = document.getElementById( 'cancel-comment-reply-link' );
							cancelClick = cancel.onclick;
							cancel.onclick = function () {
								var cancelReturn = cancelClick.call( this );
								if ( false !== cancelReturn ) {
									return cancelReturn;
								}

								if ( ! comm_par ) {
									return cancelReturn;
								}

								comm_par = 0;

								tellFrameNewParent();

								return cancelReturn;
							};
						}

						if ( comm_par == parentId ) {
							return returnValue;
						}

						comm_par = parentId;

						tellFrameNewParent();

						return returnValue;
					};
				}

				
				// Do the post message bit after the dom has loaded.
				document.addEventListener( 'DOMContentLoaded', function () {
					var iframe_url = "https:\/\/jetpack.wordpress.com";
					if ( window.postMessage ) {
						if ( document.addEventListener ) {
							window.addEventListener( 'message', function ( event ) {
								var origin = event.origin.replace( /^http:\/\//i, 'https://' );
								if ( iframe_url.replace( /^http:\/\//i, 'https://' ) !== origin ) {
									return;
								}
								jQuery( frame ).height( event.data );
							});
						} else if ( document.attachEvent ) {
							window.attachEvent( 'message', function ( event ) {
								var origin = event.origin.replace( /^http:\/\//i, 'https://' );
								if ( iframe_url.replace( /^http:\/\//i, 'https://' ) !== origin ) {
									return;
								}
								jQuery( frame ).height( event.data );
							});
						}
					}
				})

			})();
		</script>

		<script type="text/javascript" src="https://stats.wp.com/e-202035.js" async="async" defer></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:8.4.2',blog:'111052036',post:'9595',tz:'0',srv:'dbatools.io'} ]);
	_stq.push([ 'clickTrackerInit', '111052036', '9595' ]);
</script>

</body>
</html>
