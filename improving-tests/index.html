<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>improving tests: code coverage usecase &ndash; dbatools</title>
<link rel="dns-prefetch" href="//secure.gravatar.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//use.fontawesome.com">

<link rel="alternate" type="application/rss+xml" title="dbatools &raquo; Feed" href="https://dbatools.io/feed/">
<link rel="alternate" type="application/rss+xml" title="dbatools &raquo; Comments Feed" href="https://dbatools.io/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="dbatools &raquo; improving tests: code coverage usecase Comments Feed" href="https://dbatools.io/improving-tests/feed/">
<link rel="stylesheet" id="wp-block-library-css" href="https://c0.wp.com/c/5.3.4/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all">
<style id="wp-block-library-inline-css" type="text/css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="cpsh-shortcodes-css" href="https://dbatools.io/wp-content/plugins/column-shortcodes//assets/css/shortcodes.css?ver=1.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-fonts-css" href="https://fonts.googleapis.com/css?family=Raleway%3A400%2C500%2C600%2C700%2C300%2C100%2C800%2C900%7COpen+Sans%3A400%2C300%2C300italic%2C400italic%2C600%2C600italic%2C700%2C700italic&amp;subset=latin%2Clatin-ext&amp;ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-animate-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/animate.min.css?ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-fa-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/font-awesome.min.css?ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-bootstrap-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/bootstrap.min.css?ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-style-css" href="https://dbatools.io/wp-content/plugins/onepress-plus/style.css?ver=10.1.8" type="text/css" media="all">
<style id="onepress-style-inline-css" type="text/css">
#main .video-section section.hero-slideshow-wrapper{background:transparent}.hero-slideshow-wrapper:after{position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:rgba(1,36,86,1);display:block;content:""}.body-desktop .parallax-hero .hero-slideshow-wrapper:after{display:none!important}.parallax-hero .parallax-mirror:after{position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:rgba(1,36,86,1);display:block;content:""}.body-desktop .parallax-hero .hero-slideshow-wrapper:after{display:none!important}.parallax-hero .parallax-mirror:after{position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:rgba(1,36,86,1);display:block;content:""}a,.screen-reader-text:hover,.screen-reader-text:active,.screen-reader-text:focus,.header-social a,.onepress-menu a:hover,.onepress-menu ul li a:hover,.onepress-menu li.onepress-current-item>a,.onepress-menu ul li.current-menu-item>a,.onepress-menu>li a.menu-actived,.onepress-menu.onepress-menu-mobile li.onepress-current-item>a,.site-footer a,.site-footer .footer-social a:hover,.site-footer .btt a:hover,.highlight,#comments .comment .comment-wrapper .comment-meta .comment-time:hover,#comments .comment .comment-wrapper .comment-meta .comment-reply-link:hover,#comments .comment .comment-wrapper .comment-meta .comment-edit-link:hover,.btn-theme-primary-outline,.sidebar .widget a:hover,.section-services .service-item .service-image i,.counter_item .counter__number,.team-member .member-thumb .member-profile a:hover,.icon-background-default{color:#012456}input[type="reset"],input[type="submit"],input[type="submit"],.nav-links a:hover,.btn-theme-primary,.btn-theme-primary-outline:hover,.card-theme-primary,.woocommerce #respond input#submit,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce button.button.alt{background:#012456}.btn-theme-primary-outline,.btn-theme-primary-outline:hover,.pricing__item:hover,.card-theme-primary,.entry-content blockquote{border-color:#012456}.site-header{background:#e3e3e3;border-bottom:0px none}.onepress-menu>li>a{color:#293955}.onepress-menu>li>a:hover,.onepress-menu>li.onepress-current-item>a{color:#444444;-webkit-transition:all 0.5s ease-in-out;-moz-transition:all 0.5s ease-in-out;-o-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}#nav-toggle span,#nav-toggle span::before,#nav-toggle span::after,#nav-toggle.nav-is-visible span::before,#nav-toggle.nav-is-visible span::after{background:#293955}.site-footer{background-color:#012456}.site-footer .footer-connect .follow-heading{color:rgba(255,255,255,0.9)}.site-footer .site-info,.site-footer .btt a{background-color:#545454}.site-footer .site-info{color:rgba(255,255,255,0.7)}.site-footer .btt a,.site-footer .site-info a{color:rgba(255,255,255,0.9)}.gallery-carousel .g-item{padding:0px 10px}.gallery-carousel{margin-left:-10px;margin-right:-10px}.gallery-grid .g-item,.gallery-masonry .g-item .inner{padding:10px}.gallery-grid,.gallery-masonry{margin:-10px}
/* --- Begin custom CSS --- */
.section-testimonials .card { max-width : 140px; }
/* --- End custom CSS --- */

 .section-features{ background-color: rgba(227,227,227,1); } 
 
</style>
<link rel="stylesheet" id="onepress-gallery-lightgallery-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/lightgallery.css?ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="upw_theme_standard-css" href="https://dbatools.io/wp-content/plugins/ultimate-posts-widget/css/upw-theme-standard.min.css?ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-official-css" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" type="text/css" media="all" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
<link rel="stylesheet" id="onepress-child-style-css" href="https://dbatools.io/wp-content/themes/onepress/style.css?ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="sccss_style-css" href="https://dbatools.io/?sccss=1&amp;ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-official-v4shim-css" href="https://use.fontawesome.com/releases/v5.11.2/css/v4-shims.css" type="text/css" media="all" integrity="sha384-/EdpJd7d6gGFiQ/vhh7iOjiZdf4+6K4al/XrX6FxxZwDSrAdWxAynr4p/EA/vyPQ" crossorigin="anonymous">
<style id="font-awesome-official-v4shim-inline-css" type="text/css">
@font-face {
font-family: "FontAwesome";
src: url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.eot"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.eot?#iefix") format("embedded-opentype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.woff2") format("woff2"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.woff") format("woff"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.ttf") format("truetype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.svg#fontawesome") format("svg");
}

@font-face {
font-family: "FontAwesome";
src: url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.eot"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.eot?#iefix") format("embedded-opentype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.woff2") format("woff2"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.woff") format("woff"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.ttf") format("truetype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.svg#fontawesome") format("svg");
}

@font-face {
font-family: "FontAwesome";
src: url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.eot"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.eot?#iefix") format("embedded-opentype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.woff2") format("woff2"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.woff") format("woff"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.ttf") format("truetype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.svg#fontawesome") format("svg");
unicode-range: U+F004-F005,U+F007,U+F017,U+F022,U+F024,U+F02E,U+F03E,U+F044,U+F057-F059,U+F06E,U+F070,U+F075,U+F07B-F07C,U+F080,U+F086,U+F089,U+F094,U+F09D,U+F0A0,U+F0A4-F0A7,U+F0C5,U+F0C7-F0C8,U+F0E0,U+F0EB,U+F0F3,U+F0F8,U+F0FE,U+F111,U+F118-F11A,U+F11C,U+F133,U+F144,U+F146,U+F14A,U+F14D-F14E,U+F150-F152,U+F15B-F15C,U+F164-F165,U+F185-F186,U+F191-F192,U+F1AD,U+F1C1-F1C9,U+F1CD,U+F1D8,U+F1E3,U+F1EA,U+F1F6,U+F1F9,U+F20A,U+F247-F249,U+F24D,U+F254-F25B,U+F25D,U+F267,U+F271-F274,U+F279,U+F28B,U+F28D,U+F2B5-F2B6,U+F2B9,U+F2BB,U+F2BD,U+F2C1-F2C2,U+F2D0,U+F2D2,U+F2DC,U+F2ED,U+F328,U+F358-F35B,U+F3A5,U+F3D1,U+F410,U+F4AD;
}
</style>
<link rel="stylesheet" id="jetpack_css-css" href="https://c0.wp.com/p/jetpack/8.4.2/css/jetpack.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var onepress_js_settings = {"onepress_disable_animation":"1","onepress_disable_sticky_header":"1","onepress_vertical_align_menu":"0","hero_animation":"flipInX","hero_speed":"5000000","is_home":"","gallery_enable":"1"};
var OnePress_Plus = {"ajax_url":"https:\/\/dbatools.io\/wp-admin\/admin-ajax.php","browser_warning":" Your browser does not support the video tag. I suggest you upgrade your browser."};
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/c/5.3.4/wp-includes/js/jquery/jquery.js"></script>
<script type="text/javascript" src="https://c0.wp.com/c/5.3.4/wp-includes/js/jquery/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/related-posts/related-posts.min.js"></script>


<link rel="prev" title="our prompt" href="https://dbatools.io/prompt/">
<link rel="next" title="new release &ndash; picklerick" href="https://dbatools.io/picklerick/">


<link rel="alternate" type="application/json+oembed" href="https://dbatools.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdbatools.io%2Fimproving-tests%2F">
<link rel="alternate" type="text/xml+oembed" href="https://dbatools.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdbatools.io%2Fimproving-tests%2F&amp;format=xml">

<link rel="dns-prefetch" href="//v0.wordpress.com">
<link rel="dns-prefetch" href="//widgets.wp.com">
<link rel="dns-prefetch" href="//s0.wp.com">
<link rel="dns-prefetch" href="//0.gravatar.com">
<link rel="dns-prefetch" href="//1.gravatar.com">
<link rel="dns-prefetch" href="//2.gravatar.com">
<link rel="dns-prefetch" href="//i0.wp.com">
<link rel="dns-prefetch" href="//i1.wp.com">
<link rel="dns-prefetch" href="//i2.wp.com">
<link rel="dns-prefetch" href="//c0.wp.com">
<link rel="dns-prefetch" href="//jetpack.wordpress.com">
<link rel="dns-prefetch" href="//s1.wp.com">
<link rel="dns-prefetch" href="//s2.wp.com">
<link rel="dns-prefetch" href="//public-api.wordpress.com">
<style type="text/css">img#wpstats{display:none}</style><link rel="canonical" href="https://dbatools.io/improving-tests/">
			<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
			<script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
		

<meta property="og:type" content="article">
<meta property="og:title" content="improving tests: code coverage usecase">
<meta property="og:url" content="https://dbatools.io/improving-tests/">
<meta property="og:description" content="A recent addition to the release pipeline is the &ldquo;code coverage&rdquo; report. Although you can find several posts about the intricacies of code coverage for PowerShell (my favourite is this &hellip;">
<meta property="article:published_time" content="2017-11-17T13:01:57+00:00">
<meta property="article:modified_time" content="2017-11-17T16:07:05+00:00">
<meta property="og:site_name" content="dbatools">
<meta property="og:image" content="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_3.png">
<meta property="og:image:width" content="755">
<meta property="og:image:height" content="262">
<meta property="og:locale" content="en_US">
<meta name="twitter:text:title" content="improving tests: code coverage usecase">
<meta name="twitter:card" content="summary">


<link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=32%2C32&amp;ssl=1" sizes="32x32">
<link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1">
<meta name="msapplication-TileImage" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1">

<style class="wp-typography-print-styles" type="text/css">
body, body p { 
	font-style: normal;
	text-transform: none;
 } 
 .onepress-menu a { 
	font-style: normal;
	text-transform: none;
 } 
 body h1, body h2, body h3, body h4, body h5, body h6,
    body .section-title-area .section-title, body .section-title-area .section-subtitle, body .hero-content-style1 h2 { 
	font-style: normal;
	text-transform: none;
 }
</style>
			<style type="text/css" id="wp-custom-css">
				/*
Welcome to Custom CSS!

To learn how this works, see http://wp.me/PEmnE-Bt
*/			</style>
		</head>

<body class="post-template-default single single-post postid-6559 single-format-standard wp-custom-logo group-blog no-sticky-header">
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
            <header id="masthead" class="site-header" role="banner">
            <div class="container">
                <div class="site-branding">
                <div class="site-brand-inner has-logo-img no-desc"><div class="site-logo-div"><a href="https://dbatools.io/" class="custom-logo-link" rel="home"><img width="223" height="64" src="https://dbatools.io/wp-content/uploads/2016/05/dbatools-logo-1.png?fit=223%2C64&amp;ssl=1" class="custom-logo jetpack-lazy-image" alt="dbatools" data-lazy-src="https://dbatools.io/wp-content/uploads/2016/05/dbatools-logo-1.png?fit=223%2C64&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "></a></div></div>                </div>
                

                <div class="header-right-wrapper">
                    <a href="#0" id="nav-toggle">Menu<span></span></a>
                    <nav id="site-navigation" class="main-navigation" role="navigation">
                        <ul class="onepress-menu">
                            <li id="menu-item-1452" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1452"><a href="https://dbatools.io/download/">&#11015; download</a>
<ul class="sub-menu">
	<li id="menu-item-1451" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1451"><a href="https://dbatools.io/getting-started/">get started</a></li>
</ul>
</li>
<li id="menu-item-1453" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1453"><a href="https://dbatools.io/commands/">&#128640; commands</a></li>
<li id="menu-item-8268" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-8268"><a href="https://dbatools.io/docs">&#128209; docs</a>
<ul class="sub-menu">
	<li id="menu-item-8270" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8270"><a href="https://dbatools.io/blog">blog</a></li>
</ul>
</li>
<li id="menu-item-1456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1456"><a href="https://dbatools.io/team/">&#129395; team</a>
<ul class="sub-menu">
	<li id="menu-item-3315" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3315"><a href="https://dbatools.io/contributing">contribute</a></li>
	<li id="menu-item-3123" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3123"><a href="https://dbatools.io/contact/">contact</a></li>
	<li id="menu-item-3116" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-3116"><a href="https://dbatools.io/git">find us</a>
	<ul class="sub-menu">
		<li id="menu-item-4663" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4663"><a href="https://dbatools.io/slack">slack</a></li>
		<li id="menu-item-4662" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4662"><a href="https://dbatools.io/github">github</a></li>
		<li id="menu-item-4664" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4664"><a href="https://dbatools.io/twitter">twitter</a></li>
		<li id="menu-item-4665" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4665"><a href="https://dbatools.io/youtube">youtube</a></li>
		<li id="menu-item-4666" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4666"><a href="https://dbatools.io/linkedin">linkedin</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-3340" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3340"><a href="https://dbatools.io/subscribe/">&#128140; subscribe</a></li>
<li id="menu-item-6587" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6587"><a href="https://dbatools.io/builds">&#10004; build ref</a></li>
<li id="menu-item-9781" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9781"><a href="https://dbatools.io/sponsorship/">&#128149; sponsor</a></li>
<li id="menu-item-9994" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9994"><a href="https://dbatools.io/book">&#128216; book</a></li>
                        </ul>
                    </nav>
                    
                </div>
            </div>
        </header>
        
	<div id="content" class="site-content">

		
		<div id="content-inside" class="container right-sidebar">
			<div id="primary" class="content-area">
				<main id="main" class="site-main" role="main">

				
					
<article id="post-6559" class="post-6559 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements tag-party">
	<header class="entry-header">
		<h1 class="entry-title">improving tests: code coverage usecase</h1>
		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://dbatools.io/improving-tests/" rel="bookmark"><time class="entry-date published" datetime="2017-11-17T13:01:57+00:00">November 17, 2017</time><time class="updated hide" datetime="2017-11-17T16:07:05+00:00">November 17, 2017</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://dbatools.io/author/niphlod/">Simone Bizzotto</a></span></span>		</div>
	</header>

	<div class="entry-content">
		<p>A recent addition to the release pipeline is the &ldquo;code coverage&rdquo; report. Although you can find several posts about the intricacies of code coverage for PowerShell (my favourite is <a href="https://www.sapien.com/blog/2016/06/24/testing-pester-code-coverage/">this post by June Blender</a>), you may be asking yourself what is code coverage in simple terms.</p>
<h2>defining code coverage</h2>
<blockquote><p>Coupled with tests, code coverage is a metric that measures how much of the code is tested.</p></blockquote>
<p>This is helpful to realize the test written is really covering for all the &ldquo;features&rdquo; of the code. A function with a test is a good thing. A function with a test that covers the 10% of the lines definitely helps, but tells you that a lot of the code involved may not be failproof.</p>
<p>While reaching 100% is not entirely possible due to Powershell limitations, it should be the goal for everyone. The more code coverage we reach:</p>
<ul>
<li>the more stable the module.</li>
<li>the more &ldquo;situations&rdquo; are being checked and handled correctly</li>
<li>the more tests will be complete, documenting what to expect from the function</li>
<li>the more documentation about how a function needs to behave, the more users can fiddle with the code and add features being sure they don&rsquo;t break anything in the process</li>
</ul>
<p>We run a suite of tests at each commit via <a href="https://appveyor.com">appveyor</a>. The service we chose for code coverage is <a href="https://codecov.io">codecov</a>. We chose them mostly due to the fact that their support is great and we needed their exclusive feature of &ldquo;merge report&rdquo; because we run different test suites for each build (even some C# code). Also, its interface is as good as a code coverage report can be, you can see the full source code and line-by-line coverage.</p>
<h2>dbatools coverage</h2>
<p>For public consumption, <a href="https://codecov.io/gh/sqlcollaborative/dbatools/branch/development">our development branch</a> shows the most current coverage report for the whole project.</p>
<p>Now that the project is open about coverage metrics, you can contribute to the project writing more complete tests for all functions which are not 100% covered.</p>
<p>Let&rsquo;s see a practical example.</p>
<p>A few days ago, on 2017-11-13, the development branch showed Get-DbaDbRecoveryModel.ps1 with a <a href="https://codecov.io/gh/sqlcollaborative/dbatools/tree/6870dccda543988eb952f574de9f758134ee85d5/functions">90% coverage</a>. Codecov&rsquo;s urls are prettier but for the sake of this blogpost, which must point to specific commits, they&rsquo;ll be lengthy and ugly.</p>
<figure id="attachment_6560" aria-describedby="caption-attachment-6560" style="width: 800px" class="wp-caption alignnone"><img class="wp-image-6560 size-large jetpack-lazy-image" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?resize=800%2C130&amp;ssl=1" alt width="800" height="130" data-recalc-dims="1" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?resize=1024%2C166&amp;ssl=1 1024w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?resize=300%2C49&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?resize=768%2C125&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?w=1799&amp;ssl=1 1799w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?w=1600&amp;ssl=1 1600w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?resize=800%2C130&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img class="wp-image-6560 size-large" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?resize=800%2C130&amp;ssl=1" alt="" width="800" height="130" srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?resize=1024%2C166&amp;ssl=1 1024w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?resize=300%2C49&amp;ssl=1 300w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?resize=768%2C125&amp;ssl=1 768w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?w=1799&amp;ssl=1 1799w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_1.png?w=1600&amp;ssl=1 1600w" sizes="(max-width: 800px) 100vw, 800px" data-recalc-dims="1"></noscript><figcaption id="caption-attachment-6560" class="wp-caption-text">original coverage</figcaption></figure>
<p>Clicking on the <a href="https://codecov.io/gh/sqlcollaborative/dbatools/src/6870dccda543988eb952f574de9f758134ee85d5/functions/Set-DbaDbRecoveryModel.ps1">function itself</a>, you can see that only one line is specifically not covered</p>
<figure id="attachment_6561" aria-describedby="caption-attachment-6561" style="width: 800px" class="wp-caption alignnone"><img class="wp-image-6561 size-large jetpack-lazy-image" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?resize=800%2C127&amp;ssl=1" alt width="800" height="127" data-recalc-dims="1" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?resize=1024%2C162&amp;ssl=1 1024w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?resize=300%2C48&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?resize=768%2C122&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?w=1716&amp;ssl=1 1716w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?w=1600&amp;ssl=1 1600w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?resize=800%2C127&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img class="wp-image-6561 size-large" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?resize=800%2C127&amp;ssl=1" alt="" width="800" height="127" srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?resize=1024%2C162&amp;ssl=1 1024w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?resize=300%2C48&amp;ssl=1 300w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?resize=768%2C122&amp;ssl=1 768w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?w=1716&amp;ssl=1 1716w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_2.png?w=1600&amp;ssl=1 1600w" sizes="(max-width: 800px) 100vw, 800px" data-recalc-dims="1"></noscript><figcaption id="caption-attachment-6561" class="wp-caption-text">original coverage &ndash; source details</figcaption></figure>
<p>Line 87 basically is about the possibility to specify a specific recovery model as a filter to retrieve only matching databases.</p>
<p>If you run <strong>Get-Help Get-DbaDbRecoveryModel</strong> you&rsquo;ll see this parameter</p>
<pre class="lang:ps decode:true ">-RecoveryModel &lt;String[]&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Filters the output based on Recovery Model. Valid options are Simple, Full and BulkLogged
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Details about the recovery models can be found here:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://docs.microsoft.com/en-us/sql/relational-databases/backup-restore/recovery-models-sql-server

</pre>
<p>If you inspect the <a href="https://github.com/dataplat/dbatools/blob/6870dcc/tests/Get-DbaDbRecoveryModel.Tests.ps1">relevant test</a>&nbsp;you&rsquo;ll see there is nothing relative to that specific parameter.</p>
<p>Unfortunately, this means that if someone makes a modification to the function in the future, there won&rsquo;t be any assurance that parameter continues to work as expected. We want to extend that test to include that too, so that the behaviour will always be the same.</p>
<h2>giving more coverage</h2>
<p>First, we need to create a database to test against the new case. Remembering that <em>dbatoolsci_</em> is the default prefix for any resource created, let&rsquo;s go with <em>dbatoolsci_getrecoverymodel</em>.</p>
<p>Cannibalizing a recurrent pattern seen in most tests, let&rsquo;s add a new Context with a BeforeAll and an AfterAll stanzas to keep everything clean</p>
<pre class="lang:ps decode:true">Context "RecoveryModel parameter works" {
    BeforeAll {
        $server = Connect-DbaInstance -SqlInstance $script:instance2
        $dbname = "dbatoolsci_getrecoverymodel"
        Get-DbaDatabase -SqlInstance $server -Database $dbname | Remove-DbaDatabase -Confirm:$false
        $server.Query("CREATE DATABASE $dbname; ALTER DATABASE $dbname SET RECOVERY BULK_LOGGED WITH NO_WAIT;")
    }
    AfterAll {
        Get-DbaDatabase -SqlInstance $script:instance2 -Database $dbname | Remove-DbaDatabase -Confirm:$false
    }
}</pre>
<p>Summing up, <em>BeforeAll</em> runs before ANY test within the upper-level stanza (in our case, the brand new <em>Context</em>), while <em>AfterAll</em> runs after, no matter the results (keeping things clean is a priority, so cleanup needs to run no matter what)</p>
<p>You&rsquo;ll see the <em>BeforeAll</em> checks and removes any preexisting <em>dbatoolsci_getrecoverymodel</em> database, it then proceeds to create a new one with BULK_LOGGED. The <em>AfterAll</em> instead just removes the database we created. Then, we create the real test case:</p>
<pre class="lang:ps decode:true ">It "gets the newly created database with the correct recovery model" {
    $results = Get-DbaDbRecoveryModel -SqlInstance $script:instance2 -Database $dbname
    $results.RecoveryModel -eq 'BulkLogged' | Should Be $true
}
It "honors the RecoveryModel parameter filter" {
    $results = Get-DbaDbRecoveryModel -SqlInstance $script:instance2 -RecoveryModel BulkLogged
    $results.Name -contains $dbname | Should Be $true
}
</pre>
<p>Now, let&rsquo;s run the test locally, before submitting our changes. Create a <strong>C:\Temp\constants.ps1</strong> or a <strong>.\tests\local.constants.ps1</strong> that points to a live instance (in my case, the simplest of them all, <em>localhost</em>, results in this)</p>
<pre class="lang:ps decode:true">PS C:\dbatools-dev\tests&gt; get-content .\constants.local.ps1
$script:instance1 = "localhost"
$script:instance2 = "localhost"
$script:instance1_detailed = "localhost,1433"
$script:appveyorlabrepo = "C:\github\appveyor-lab"
$instances = @($script:instance1, $script:instance2)
$ssisserver = "localhost"</pre>
<p>Then, let&rsquo;s launch the test</p>
<pre class="lang:ps decode:true">.\manual.pester.ps1 -path .\Get-DbaDbRecoveryModel.Tests.ps1 -TestIntegration</pre>
<p></p><center><img class="wp-image-6562 size-full jetpack-lazy-image" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_3.png?resize=755%2C262&amp;ssl=1" alt width="755" height="262" data-recalc-dims="1" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_3.png?w=755&amp;ssl=1 755w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_3.png?resize=300%2C104&amp;ssl=1 300w" data-lazy-sizes="(max-width: 755px) 100vw, 755px" data-lazy-src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_3.png?resize=755%2C262&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img class="wp-image-6562 size-full" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_3.png?resize=755%2C262&amp;ssl=1" alt="" width="755" height="262" srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_3.png?w=755&amp;ssl=1 755w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_3.png?resize=300%2C104&amp;ssl=1 300w" sizes="(max-width: 755px) 100vw, 755px" data-recalc-dims="1"></noscript><em>manual test run</em></center>
<h2>merging to the dbatools repository</h2>
<p>Now that we&rsquo;ve confirmed that everything checks out, let&rsquo;s create the pull request (PR).</p>
<p>First, we open a proper feature branch spawned from development</p>
<pre class="lang:ps decode:true ">git checkout development
git checkout -b tests/Get-DbaRecoveryModel</pre>
<p>add the relevant commits, then push the new branch</p>
<pre class="lang:ps decode:true ">git push origin tests/Get-DbaRecoveryModel</pre>
<p>wait a few seconds, go on github and create the PR</p>
<p></p><center><img class="wp-image-6563 size-large jetpack-lazy-image" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?resize=800%2C145&amp;ssl=1" alt width="800" height="145" data-recalc-dims="1" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?resize=1024%2C186&amp;ssl=1 1024w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?resize=300%2C55&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?resize=768%2C140&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?w=1304&amp;ssl=1 1304w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?resize=800%2C145&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img class="wp-image-6563 size-large" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?resize=800%2C145&amp;ssl=1" alt="" width="800" height="145" srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?resize=1024%2C186&amp;ssl=1 1024w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?resize=300%2C55&amp;ssl=1 300w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?resize=768%2C140&amp;ssl=1 768w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_4.png?w=1304&amp;ssl=1 1304w" sizes="(max-width: 800px) 100vw, 800px" data-recalc-dims="1"></noscript> <em>open a PR</em></center>
<p>change the base branch to development</p>
<p></p><center><img class="wp-image-6564 size-full jetpack-lazy-image" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_5.png?resize=753%2C232&amp;ssl=1" alt width="753" height="232" data-recalc-dims="1" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_5.png?w=753&amp;ssl=1 753w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_5.png?resize=300%2C92&amp;ssl=1 300w" data-lazy-sizes="(max-width: 753px) 100vw, 753px" data-lazy-src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_5.png?resize=753%2C232&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img class="wp-image-6564 size-full" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_5.png?resize=753%2C232&amp;ssl=1" alt="" width="753" height="232" srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_5.png?w=753&amp;ssl=1 753w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_5.png?resize=300%2C92&amp;ssl=1 300w" sizes="(max-width: 753px) 100vw, 753px" data-recalc-dims="1"></noscript> <em>change base branch</em></center>
<p>Once you filled out the details, you&rsquo;ll have written something like <a href="https://github.com/dataplat/dbatools/pull/2646">this PR</a></p>
<p>Now, we just wait for the build to complete (impatient ones, watch <a href="https://dbatools.io/ci">appveyor&rsquo;s dbatools &ldquo;homepage&rdquo;</a>&nbsp;to monitor the status in real-time)</p>
<h2>inspecting the results</h2>
<p>Once the build has done, the list of recent opened PRs on codecov is at <a href="https://codecov.io/gh/sqlcollaborative/dbatools/pulls">dbatools.io/coverage</a></p>
<p>If you inspect the one I created with this blogpost, which is <a href="https://codecov.io/gh/sqlcollaborative/dbatools/pull/2646">#2646</a>&nbsp;, when you browse to the <a href="https://codecov.io/gh/sqlcollaborative/dbatools/pull/2646/tree/functions">functions folder</a>&nbsp;to see what happened with the coverage of Get-DbaRecoveryModel.ps1 &hellip; voil&agrave;</p>
<p></p><center><img class="wp-image-6565 size-large jetpack-lazy-image" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?resize=800%2C129&amp;ssl=1" alt width="800" height="129" data-recalc-dims="1" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?resize=1024%2C165&amp;ssl=1 1024w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?resize=300%2C48&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?resize=768%2C124&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?w=1814&amp;ssl=1 1814w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?w=1600&amp;ssl=1 1600w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?resize=800%2C129&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img class="wp-image-6565 size-large" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?resize=800%2C129&amp;ssl=1" alt="" width="800" height="129" srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?resize=1024%2C165&amp;ssl=1 1024w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?resize=300%2C48&amp;ssl=1 300w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?resize=768%2C124&amp;ssl=1 768w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?w=1814&amp;ssl=1 1814w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_6.png?w=1600&amp;ssl=1 1600w" sizes="(max-width: 800px) 100vw, 800px" data-recalc-dims="1"></noscript><em>coverage increase</em></center>
<p>You can click further to see the <a href="https://codecov.io/gh/sqlcollaborative/dbatools/src/be3a3d976f1393a688bd2a437e452ab9c7d399f5/functions/Get-DbaDbRecoveryModel.ps1">details</a>: you can see that the line which wasn&rsquo;t covered is now green.</p>
<p></p><center><img class="wp-image-6566 size-large jetpack-lazy-image" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?resize=800%2C98&amp;ssl=1" alt width="800" height="98" data-recalc-dims="1" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?resize=1024%2C125&amp;ssl=1 1024w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?resize=300%2C37&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?resize=768%2C94&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?w=1494&amp;ssl=1 1494w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?resize=800%2C98&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img class="wp-image-6566 size-large" src="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?resize=800%2C98&amp;ssl=1" alt="" width="800" height="98" srcset="https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?resize=1024%2C125&amp;ssl=1 1024w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?resize=300%2C37&amp;ssl=1 300w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?resize=768%2C94&amp;ssl=1 768w,https://dbatools.io/wp-content/uploads/2017/11/blogpost_improving_tests_7.png?w=1494&amp;ssl=1 1494w" sizes="(max-width: 800px) 100vw, 800px" data-recalc-dims="1"></noscript><em>coverage increase line by line</em></center>
<p>Enjoyed this post? Come join the Pester-lovers on <a href="https://dbatools.io/slack">Slack&rsquo;s</a> #dbatools-pester to improve current tests!</p>
<p>Ciao!<br>
Simone &#127470;&#127481;</p>

<div id="jp-relatedposts" class="jp-relatedposts">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>			</div>

	<footer class="entry-footer">
		<span class="tags-links">Tagged <a href="https://dbatools.io/tag/party/" rel="tag">party</a></span>	</footer>
</article>


					
<div id="comments" class="comments-area">

	
	
	
	
		<div id="respond" class="comment-respond">
							<h3 id="reply-title" class="comment-reply-title">Leave a Reply					<small><a rel="nofollow" id="cancel-comment-reply-link" href="https://dbatools.io/improving-tests/#respond" style="display:none;">Cancel reply</a></small>
				</h3>
						<form id="commentform" class="comment-form">
				<iframe title="Comment Form" src="https://jetpack.wordpress.com/jetpack-comment/?blogid=111052036&amp;postid=6559&amp;comment_registration=0&amp;require_name_email=1&amp;stc_enabled=1&amp;stb_enabled=1&amp;show_avatars=1&amp;avatar_default=mystery&amp;greeting=Leave+a+Reply&amp;greeting_reply=Leave+a+Reply+to+%25s&amp;color_scheme=light&amp;lang=en_US&amp;jetpack_version=8.4.2&amp;show_cookie_consent=10&amp;has_cookie_consent=0&amp;token_key=%3Bnormal%3B&amp;sig=6c090deb902110ddbcd891ec7bf679034e3cffbe#parent=https%3A%2F%2Fdbatools.io%2Fimproving-tests%2F" style="width:100%; height: 430px; border:0;" name="jetpack_remote_comment" class="jetpack_remote_comment" id="jetpack_remote_comment" sandbox="allow-same-origin allow-top-navigation allow-scripts allow-forms allow-popups"></iframe>
									
					<script>
						document.addEventListener('DOMContentLoaded', function () {
							var commentForms = document.getElementsByClassName('jetpack_remote_comment');
							for (var i = 0; i < commentForms.length; i++) {
								commentForms[i].allowTransparency = false;
								commentForms[i].scrolling = 'no';
							}
						});
					</script>
					
							</form>
		</div>

		
		<input type="hidden" name="comment_parent" id="comment_parent" value="">

		<p class="akismet_comment_form_privacy_notice">This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" target="_blank" rel="nofollow noopener">Learn how your comment data is processed</a>.</p>
</div>

				
				</main>
			</div>

                            
<div id="secondary" class="widget-area sidebar" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://dbatools.io/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="Search">
			</form></aside><aside id="custom_html-3" class="widget_text widget widget_custom_html"><h2 class="widget-title">new book</h2><div class="textwidget custom-html-widget">dbatools in a month of lunches is now available in Manning's Early Access Program &#128640; <br>&nbsp;

<p align="center"><a href="https://dbatools.io/book"><img alt="dbatools meap" src="https://blog.netnerds.net/wp-content/uploads/2019/08/meap.png?w=800&amp;ssl=1" data-recalc-dims="1" data-lazy-src="https://blog.netnerds.net/wp-content/uploads/2019/08/meap.png?w=800&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " class=" jetpack-lazy-image"><noscript><img alt="dbatools meap" src="https://blog.netnerds.net/wp-content/uploads/2019/08/meap.png?w=800&amp;ssl=1" data-recalc-dims="1"></noscript></a></p>

Get the book now at <a href="https://dbatools.io/book">manning.com</a></div></aside><aside id="sticky-posts-2" class="widget widget_ultimate_posts"><h2 class="widget-title"><a href="https://dbatools.io/blog">posts</a></h2>

<div class="upw-posts hfeed">

  
      
        
        <article class="post-10008 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/aliases/" rel="bookmark">
                  <img width="300" height="155" src="https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?fit=300%2C155&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?w=905&amp;ssl=1 905w, https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?resize=300%2C155&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?resize=768%2C396&amp;ssl=1 768w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?fit=300%2C155&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/aliases/" rel="bookmark">
                  working with sql client aliases                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-10124 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/bits2020/" rel="bookmark">
                  <img width="300" height="108" src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/bits2020/" rel="bookmark">
                  Vote for these SQLBits 2020 PowerShell sessions                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-10010 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/size/" rel="bookmark">
                  <img width="300" height="139" src="https://dbatools.io/wp-content/uploads/2019/09/disksize.png?fit=300%2C139&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2019/09/disksize.png?w=1139&amp;ssl=1 1139w, https://dbatools.io/wp-content/uploads/2019/09/disksize.png?resize=300%2C139&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2019/09/disksize.png?resize=768%2C355&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2019/09/disksize.png?resize=1024%2C473&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://dbatools.io/wp-content/uploads/2019/09/disksize.png?fit=300%2C139&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/size/" rel="bookmark">
                  working with file sizes in dbatools                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-9995 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements tag-book tag-dbatoolsmol tag-monthoflunches">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/meap/" rel="bookmark">
                  <img width="300" height="159" src="https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?fit=300%2C159&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?w=1287&amp;ssl=1 1287w, https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?resize=300%2C159&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?resize=768%2C408&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?resize=1024%2C543&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?fit=300%2C159&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/meap/" rel="bookmark">
                  Learn dbatools in a Month of Lunches                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-9928 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/oldapp/" rel="bookmark">
                  <img width="300" height="108" src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/oldapp/" rel="bookmark">
                  migrating super old app databases                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-9862 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements tag-dbatools-configs tag-dbatools-settings tag-defaults">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/configuration/" rel="bookmark">
                  <img width="300" height="202" src="https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?fit=300%2C202&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?w=1104&amp;ssl=1 1104w, https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?resize=300%2C202&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?resize=768%2C516&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?resize=1024%2C688&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?fit=300%2C202&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/configuration/" rel="bookmark">
                  dbatools advanced configuration                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
  
</div>

</aside><aside id="blog_subscription-2" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title">subscribe</h2>
            <form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
				                    <div id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
</div><p>Join 2,166 other subscribers</p>
                    <p id="subscribe-email">
                        <label id="jetpack-subscribe-label" class="screen-reader-text" for="subscribe-field-blog_subscription-2">
							email                        </label>
                        <input type="email" name="email" required="required" class="required" value="" id="subscribe-field-blog_subscription-2" placeholder="email">
                    </p>

                    <p id="subscribe-submit">
                        <input type="hidden" name="action" value="subscribe">
                        <input type="hidden" name="source" value="https://dbatools.io/improving-tests/">
                        <input type="hidden" name="sub-type" value="widget">
                        <input type="hidden" name="redirect_fragment" value="blog_subscription-2">
						                        <button type="submit" name="jetpack_subscriptions_widget">
	                        subscribe                        </button>
                    </p>
				            </form>
		
</aside><aside id="eu_cookie_law_widget-3" class="widget widget_eu_cookie_law_widget"><div class="hide-on-button" data-hide-timeout="30" data-consent-expiration="180" id="eu-cookie-law">
	<form method="post">
		<input type="submit" value="Close and accept" class="accept">
	</form>

	Privacy &amp; Cookies: This site uses cookies. By continuing to use this website, you agree to their use. <br>
To find out more, including how to control cookies, see here:
	<a href="https://automattic.com/cookies/">
		Cookie Policy	</a>
</div>
</aside></div>
            
		</div>
	</div>

    <footer id="colophon" class="site-footer" role="contentinfo">
                    <div class="footer-connect">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-2"></div>
                        
                        <div class="col-sm-8">
                                                            <div class="footer-social">
                                    <h5 class="follow-heading">dbatools on the web</h5><div class="footer-social-icons"><a target="_blank" href="http://git.io/b3oo" title="github"><i class="fa fa-github"></i></a><a target="_blank" href="https://www.youtube.com/channel/UC1qrq0zfswSM_Uf9-vBrsiw" title="YouTube"><i class="fa fa-youtube"></i></a><a target="_blank" href="https://dbatools.io/slack" title="Slack"><i class="fa fa-slack"></i></a><a target="_blank" href="https://twitter.com/psdbatools" title="Twitter"><i class="fa fa-twitter"></i></a><a target="_blank" href="https://www.linkedin.com/company/dbatools.io" title="LinkedIn"><i class="fa fa-linkedin-square fa-linkedin"></i></a><a target="_blank" href="https://twitch.tv/dbatools" title="Twitch"><i class="fa fa-twitch"></i></a><a target="_blank" href="https://dbatools.io/book" title="Manning"><i class="fa fa-book fa-manning"></i></a></div>                                </div>
                                                    </div>
                        <div class="col-sm-2"></div>
                    </div>
                </div>
            </div>
        
        <div class="site-info">
            <div class="container">
                                &copy; 2020 Chrissy LeMaire, PowerShell and SQL Server MVP<br><a href="https://dbatools.io/contact">Contact Us</a>            </div>
        </div>
        

    </footer>
</div>

<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/photon/photon.min.js"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/plugins.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/bootstrap.min.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/lightgallery.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/theme.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/widgets/eu-cookie-law/eu-cookie-law.min.js"></script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/lazy-images/js/lazy-images.min.js"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/plugins/onepress-plus/assets/js/onepress-plus.js?ver=10.1.8"></script>
<script async="async" type="text/javascript" src="https://dbatools.io/wp-content/plugins/akismet/_inc/form.js?ver=4.1.4"></script>

		
		<script type="text/javascript">
			(function () {
				var comm_par_el = document.getElementById( 'comment_parent' ),
					comm_par = ( comm_par_el && comm_par_el.value ) ? comm_par_el.value : '',
					frame = document.getElementById( 'jetpack_remote_comment' ),
					tellFrameNewParent;

				tellFrameNewParent = function () {
					if ( comm_par ) {
						frame.src = "https://jetpack.wordpress.com/jetpack-comment/?blogid=111052036&postid=6559&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=1&avatar_default=mystery&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=8.4.2&show_cookie_consent=10&has_cookie_consent=0&token_key=%3Bnormal%3B&sig=6c090deb902110ddbcd891ec7bf679034e3cffbe#parent=https%3A%2F%2Fdbatools.io%2Fimproving-tests%2F" + '&replytocom=' + parseInt( comm_par, 10 ).toString();
					} else {
						frame.src = "https://jetpack.wordpress.com/jetpack-comment/?blogid=111052036&postid=6559&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=1&avatar_default=mystery&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=8.4.2&show_cookie_consent=10&has_cookie_consent=0&token_key=%3Bnormal%3B&sig=6c090deb902110ddbcd891ec7bf679034e3cffbe#parent=https%3A%2F%2Fdbatools.io%2Fimproving-tests%2F";
					}
				};

				
				if ( 'undefined' !== typeof addComment ) {
					addComment._Jetpack_moveForm = addComment.moveForm;

					addComment.moveForm = function ( commId, parentId, respondId, postId ) {
						var returnValue = addComment._Jetpack_moveForm( commId, parentId, respondId, postId ),
							cancelClick, cancel;

						if ( false === returnValue ) {
							cancel = document.getElementById( 'cancel-comment-reply-link' );
							cancelClick = cancel.onclick;
							cancel.onclick = function () {
								var cancelReturn = cancelClick.call( this );
								if ( false !== cancelReturn ) {
									return cancelReturn;
								}

								if ( ! comm_par ) {
									return cancelReturn;
								}

								comm_par = 0;

								tellFrameNewParent();

								return cancelReturn;
							};
						}

						if ( comm_par == parentId ) {
							return returnValue;
						}

						comm_par = parentId;

						tellFrameNewParent();

						return returnValue;
					};
				}

				
				// Do the post message bit after the dom has loaded.
				document.addEventListener( 'DOMContentLoaded', function () {
					var iframe_url = "https:\/\/jetpack.wordpress.com";
					if ( window.postMessage ) {
						if ( document.addEventListener ) {
							window.addEventListener( 'message', function ( event ) {
								var origin = event.origin.replace( /^http:\/\//i, 'https://' );
								if ( iframe_url.replace( /^http:\/\//i, 'https://' ) !== origin ) {
									return;
								}
								jQuery( frame ).height( event.data );
							});
						} else if ( document.attachEvent ) {
							window.attachEvent( 'message', function ( event ) {
								var origin = event.origin.replace( /^http:\/\//i, 'https://' );
								if ( iframe_url.replace( /^http:\/\//i, 'https://' ) !== origin ) {
									return;
								}
								jQuery( frame ).height( event.data );
							});
						}
					}
				})

			})();
		</script>

		<script type="text/javascript" src="https://stats.wp.com/e-202035.js" async="async" defer></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:8.4.2',blog:'111052036',post:'6559',tz:'0',srv:'dbatools.io'} ]);
	_stq.push([ 'clickTrackerInit', '111052036', '6559' ]);
</script>

</body>
</html>
