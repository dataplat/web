<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>multithreading commands &ndash; dbatools</title>
<link rel="dns-prefetch" href="//secure.gravatar.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//use.fontawesome.com">

<link rel="alternate" type="application/rss+xml" title="dbatools &raquo; Feed" href="https://dbatools.io/feed/">
<link rel="alternate" type="application/rss+xml" title="dbatools &raquo; Comments Feed" href="https://dbatools.io/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="dbatools &raquo; multithreading commands Comments Feed" href="https://dbatools.io/multithread/feed/">
<link rel="stylesheet" id="wp-block-library-css" href="https://c0.wp.com/c/5.3.4/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all">
<style id="wp-block-library-inline-css" type="text/css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="cpsh-shortcodes-css" href="https://dbatools.io/wp-content/plugins/column-shortcodes//assets/css/shortcodes.css?ver=1.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-fonts-css" href="https://fonts.googleapis.com/css?family=Raleway%3A400%2C500%2C600%2C700%2C300%2C100%2C800%2C900%7COpen+Sans%3A400%2C300%2C300italic%2C400italic%2C600%2C600italic%2C700%2C700italic&amp;subset=latin%2Clatin-ext&amp;ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-animate-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/animate.min.css?ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-fa-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/font-awesome.min.css?ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-bootstrap-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/bootstrap.min.css?ver=11.0.0" type="text/css" media="all">
<link rel="stylesheet" id="onepress-style-css" href="https://dbatools.io/wp-content/plugins/onepress-plus/style.css?ver=10.1.8" type="text/css" media="all">
<style id="onepress-style-inline-css" type="text/css">
#main .video-section section.hero-slideshow-wrapper{background:transparent}.hero-slideshow-wrapper:after{position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:rgba(1,36,86,1);display:block;content:""}.body-desktop .parallax-hero .hero-slideshow-wrapper:after{display:none!important}.parallax-hero .parallax-mirror:after{position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:rgba(1,36,86,1);display:block;content:""}.body-desktop .parallax-hero .hero-slideshow-wrapper:after{display:none!important}.parallax-hero .parallax-mirror:after{position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:rgba(1,36,86,1);display:block;content:""}a,.screen-reader-text:hover,.screen-reader-text:active,.screen-reader-text:focus,.header-social a,.onepress-menu a:hover,.onepress-menu ul li a:hover,.onepress-menu li.onepress-current-item>a,.onepress-menu ul li.current-menu-item>a,.onepress-menu>li a.menu-actived,.onepress-menu.onepress-menu-mobile li.onepress-current-item>a,.site-footer a,.site-footer .footer-social a:hover,.site-footer .btt a:hover,.highlight,#comments .comment .comment-wrapper .comment-meta .comment-time:hover,#comments .comment .comment-wrapper .comment-meta .comment-reply-link:hover,#comments .comment .comment-wrapper .comment-meta .comment-edit-link:hover,.btn-theme-primary-outline,.sidebar .widget a:hover,.section-services .service-item .service-image i,.counter_item .counter__number,.team-member .member-thumb .member-profile a:hover,.icon-background-default{color:#012456}input[type="reset"],input[type="submit"],input[type="submit"],.nav-links a:hover,.btn-theme-primary,.btn-theme-primary-outline:hover,.card-theme-primary,.woocommerce #respond input#submit,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce button.button.alt{background:#012456}.btn-theme-primary-outline,.btn-theme-primary-outline:hover,.pricing__item:hover,.card-theme-primary,.entry-content blockquote{border-color:#012456}.site-header{background:#e3e3e3;border-bottom:0px none}.onepress-menu>li>a{color:#293955}.onepress-menu>li>a:hover,.onepress-menu>li.onepress-current-item>a{color:#444444;-webkit-transition:all 0.5s ease-in-out;-moz-transition:all 0.5s ease-in-out;-o-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}#nav-toggle span,#nav-toggle span::before,#nav-toggle span::after,#nav-toggle.nav-is-visible span::before,#nav-toggle.nav-is-visible span::after{background:#293955}.site-footer{background-color:#012456}.site-footer .footer-connect .follow-heading{color:rgba(255,255,255,0.9)}.site-footer .site-info,.site-footer .btt a{background-color:#545454}.site-footer .site-info{color:rgba(255,255,255,0.7)}.site-footer .btt a,.site-footer .site-info a{color:rgba(255,255,255,0.9)}.gallery-carousel .g-item{padding:0px 10px}.gallery-carousel{margin-left:-10px;margin-right:-10px}.gallery-grid .g-item,.gallery-masonry .g-item .inner{padding:10px}.gallery-grid,.gallery-masonry{margin:-10px}
/* --- Begin custom CSS --- */
.section-testimonials .card { max-width : 140px; }
/* --- End custom CSS --- */

 .section-features{ background-color: rgba(227,227,227,1); } 
 
</style>
<link rel="stylesheet" id="onepress-gallery-lightgallery-css" href="https://dbatools.io/wp-content/themes/onepress-master/assets/css/lightgallery.css?ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="upw_theme_standard-css" href="https://dbatools.io/wp-content/plugins/ultimate-posts-widget/css/upw-theme-standard.min.css?ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-official-css" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" type="text/css" media="all" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
<link rel="stylesheet" id="onepress-child-style-css" href="https://dbatools.io/wp-content/themes/onepress/style.css?ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="sccss_style-css" href="https://dbatools.io/?sccss=1&amp;ver=5.3.4" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-official-v4shim-css" href="https://use.fontawesome.com/releases/v5.11.2/css/v4-shims.css" type="text/css" media="all" integrity="sha384-/EdpJd7d6gGFiQ/vhh7iOjiZdf4+6K4al/XrX6FxxZwDSrAdWxAynr4p/EA/vyPQ" crossorigin="anonymous">
<style id="font-awesome-official-v4shim-inline-css" type="text/css">
@font-face {
font-family: "FontAwesome";
src: url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.eot"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.eot?#iefix") format("embedded-opentype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.woff2") format("woff2"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.woff") format("woff"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.ttf") format("truetype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-brands-400.svg#fontawesome") format("svg");
}

@font-face {
font-family: "FontAwesome";
src: url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.eot"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.eot?#iefix") format("embedded-opentype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.woff2") format("woff2"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.woff") format("woff"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.ttf") format("truetype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-solid-900.svg#fontawesome") format("svg");
}

@font-face {
font-family: "FontAwesome";
src: url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.eot"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.eot?#iefix") format("embedded-opentype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.woff2") format("woff2"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.woff") format("woff"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.ttf") format("truetype"),
		url("https://use.fontawesome.com/releases/v5.11.2/webfonts/fa-regular-400.svg#fontawesome") format("svg");
unicode-range: U+F004-F005,U+F007,U+F017,U+F022,U+F024,U+F02E,U+F03E,U+F044,U+F057-F059,U+F06E,U+F070,U+F075,U+F07B-F07C,U+F080,U+F086,U+F089,U+F094,U+F09D,U+F0A0,U+F0A4-F0A7,U+F0C5,U+F0C7-F0C8,U+F0E0,U+F0EB,U+F0F3,U+F0F8,U+F0FE,U+F111,U+F118-F11A,U+F11C,U+F133,U+F144,U+F146,U+F14A,U+F14D-F14E,U+F150-F152,U+F15B-F15C,U+F164-F165,U+F185-F186,U+F191-F192,U+F1AD,U+F1C1-F1C9,U+F1CD,U+F1D8,U+F1E3,U+F1EA,U+F1F6,U+F1F9,U+F20A,U+F247-F249,U+F24D,U+F254-F25B,U+F25D,U+F267,U+F271-F274,U+F279,U+F28B,U+F28D,U+F2B5-F2B6,U+F2B9,U+F2BB,U+F2BD,U+F2C1-F2C2,U+F2D0,U+F2D2,U+F2DC,U+F2ED,U+F328,U+F358-F35B,U+F3A5,U+F3D1,U+F410,U+F4AD;
}
</style>
<link rel="stylesheet" id="jetpack_css-css" href="https://c0.wp.com/p/jetpack/8.4.2/css/jetpack.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var onepress_js_settings = {"onepress_disable_animation":"1","onepress_disable_sticky_header":"1","onepress_vertical_align_menu":"0","hero_animation":"flipInX","hero_speed":"5000000","is_home":"","gallery_enable":"1"};
var OnePress_Plus = {"ajax_url":"https:\/\/dbatools.io\/wp-admin\/admin-ajax.php","browser_warning":" Your browser does not support the video tag. I suggest you upgrade your browser."};
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/c/5.3.4/wp-includes/js/jquery/jquery.js"></script>
<script type="text/javascript" src="https://c0.wp.com/c/5.3.4/wp-includes/js/jquery/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/related-posts/related-posts.min.js"></script>


<link rel="prev" title="powershell splatting" href="https://dbatools.io/splat/">
<link rel="next" title="dbatools and docker" href="https://dbatools.io/docker/">


<link rel="alternate" type="application/json+oembed" href="https://dbatools.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdbatools.io%2Fmultithread%2F">
<link rel="alternate" type="text/xml+oembed" href="https://dbatools.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdbatools.io%2Fmultithread%2F&amp;format=xml">

<link rel="dns-prefetch" href="//v0.wordpress.com">
<link rel="dns-prefetch" href="//widgets.wp.com">
<link rel="dns-prefetch" href="//s0.wp.com">
<link rel="dns-prefetch" href="//0.gravatar.com">
<link rel="dns-prefetch" href="//1.gravatar.com">
<link rel="dns-prefetch" href="//2.gravatar.com">
<link rel="dns-prefetch" href="//i0.wp.com">
<link rel="dns-prefetch" href="//i1.wp.com">
<link rel="dns-prefetch" href="//i2.wp.com">
<link rel="dns-prefetch" href="//c0.wp.com">
<link rel="dns-prefetch" href="//jetpack.wordpress.com">
<link rel="dns-prefetch" href="//s1.wp.com">
<link rel="dns-prefetch" href="//s2.wp.com">
<link rel="dns-prefetch" href="//public-api.wordpress.com">
<style type="text/css">img#wpstats{display:none}</style><link rel="canonical" href="https://dbatools.io/multithread/">
			<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
			<script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
		

<meta property="og:type" content="article">
<meta property="og:title" content="multithreading commands">
<meta property="og:url" content="https://dbatools.io/multithread/">
<meta property="og:description" content="In this age of many companies adopting the ideas of either DevOps or SRE (Site Reliability Engineer) roles, there is constant need for automation. Mundane tasks like collecting metrics, alerts, ser&hellip;">
<meta property="article:published_time" content="2019-01-04T15:33:45+00:00">
<meta property="article:modified_time" content="2019-01-07T20:51:54+00:00">
<meta property="og:site_name" content="dbatools">
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg">
<meta property="og:locale" content="en_US">
<meta name="twitter:text:title" content="multithreading commands">
<meta name="twitter:image" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1">
<meta name="twitter:card" content="summary">


<link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=32%2C32&amp;ssl=1" sizes="32x32">
<link rel="icon" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1">
<meta name="msapplication-TileImage" content="https://dbatools.io/wp-content/uploads/2016/05/dbatools.png?fit=128%2C128&amp;ssl=1">

<style class="wp-typography-print-styles" type="text/css">
body, body p { 
	font-style: normal;
	text-transform: none;
 } 
 .onepress-menu a { 
	font-style: normal;
	text-transform: none;
 } 
 body h1, body h2, body h3, body h4, body h5, body h6,
    body .section-title-area .section-title, body .section-title-area .section-subtitle, body .hero-content-style1 h2 { 
	font-style: normal;
	text-transform: none;
 }
</style>
			<style type="text/css" id="wp-custom-css">
				/*
Welcome to Custom CSS!

To learn how this works, see http://wp.me/PEmnE-Bt
*/			</style>
		</head>

<body class="post-template-default single single-post postid-9344 single-format-standard wp-custom-logo group-blog no-sticky-header">
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
            <header id="masthead" class="site-header" role="banner">
            <div class="container">
                <div class="site-branding">
                <div class="site-brand-inner has-logo-img no-desc"><div class="site-logo-div"><a href="https://dbatools.io/" class="custom-logo-link" rel="home"><img width="223" height="64" src="https://dbatools.io/wp-content/uploads/2016/05/dbatools-logo-1.png?fit=223%2C64&amp;ssl=1" class="custom-logo jetpack-lazy-image" alt="dbatools" data-lazy-src="https://dbatools.io/wp-content/uploads/2016/05/dbatools-logo-1.png?fit=223%2C64&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "></a></div></div>                </div>
                

                <div class="header-right-wrapper">
                    <a href="#0" id="nav-toggle">Menu<span></span></a>
                    <nav id="site-navigation" class="main-navigation" role="navigation">
                        <ul class="onepress-menu">
                            <li id="menu-item-1452" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1452"><a href="https://dbatools.io/download/">&#11015; download</a>
<ul class="sub-menu">
	<li id="menu-item-1451" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1451"><a href="https://dbatools.io/getting-started/">get started</a></li>
</ul>
</li>
<li id="menu-item-1453" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1453"><a href="https://dbatools.io/commands/">&#128640; commands</a></li>
<li id="menu-item-8268" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-8268"><a href="https://dbatools.io/docs">&#128209; docs</a>
<ul class="sub-menu">
	<li id="menu-item-8270" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8270"><a href="https://dbatools.io/blog">blog</a></li>
</ul>
</li>
<li id="menu-item-1456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1456"><a href="https://dbatools.io/team/">&#129395; team</a>
<ul class="sub-menu">
	<li id="menu-item-3315" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3315"><a href="https://dbatools.io/contributing">contribute</a></li>
	<li id="menu-item-3123" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3123"><a href="https://dbatools.io/contact/">contact</a></li>
	<li id="menu-item-3116" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-3116"><a href="https://dbatools.io/git">find us</a>
	<ul class="sub-menu">
		<li id="menu-item-4663" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4663"><a href="https://dbatools.io/slack">slack</a></li>
		<li id="menu-item-4662" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4662"><a href="https://dbatools.io/github">github</a></li>
		<li id="menu-item-4664" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4664"><a href="https://dbatools.io/twitter">twitter</a></li>
		<li id="menu-item-4665" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4665"><a href="https://dbatools.io/youtube">youtube</a></li>
		<li id="menu-item-4666" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4666"><a href="https://dbatools.io/linkedin">linkedin</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-3340" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-3340"><a href="https://dbatools.io/subscribe/">&#128140; subscribe</a></li>
<li id="menu-item-6587" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6587"><a href="https://dbatools.io/builds">&#10004; build ref</a></li>
<li id="menu-item-9781" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9781"><a href="https://dbatools.io/sponsorship/">&#128149; sponsor</a></li>
<li id="menu-item-9994" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-9994"><a href="https://dbatools.io/book">&#128216; book</a></li>
                        </ul>
                    </nav>
                    
                </div>
            </div>
        </header>
        
	<div id="content" class="site-content">

		
		<div id="content-inside" class="container right-sidebar">
			<div id="primary" class="content-area">
				<main id="main" class="site-main" role="main">

				
					
<article id="post-9344" class="post-9344 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">
	<header class="entry-header">
		<h1 class="entry-title">multithreading commands</h1>
		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="https://dbatools.io/multithread/" rel="bookmark"><time class="entry-date published" datetime="2019-01-04T15:33:45+00:00">January 4, 2019</time><time class="updated hide" datetime="2019-01-07T20:51:54+00:00">January 7, 2019</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://dbatools.io/author/kin/">Kin</a></span></span>		</div>
	</header>

	<div class="entry-content">
		<p>In this age of many companies adopting the ideas of either DevOps or <a href="https://landing.google.com/sre/" target="_blank" rel="noopener">SRE</a> (Site Reliability Engineer) roles, there is constant need for automation. Mundane tasks like collecting metrics, alerts, server and database asset info into a central database on which you can do reporting is now a common task that many DBAs or system admins are performing.</p>
<p>In SQL Server world, we are fortunate to have a vibrant community of <a href="https://dbatools.io/team">PowerShell enthusiasts</a> that have open sourced <a href="https://dbatools.io/download">dbatools</a> &ndash; a community driven PowerShell module to automate database development and administration.</p>
<p>This begs a question..</p>
<h2>Why do we need automation?</h2>
<p>We need automation to get rid of repetitive tasks that we have to perform on a daily basis. It is often said:</p>
<blockquote><p>
  If you have to repeat it, better automate it.
</p></blockquote>
<p>This makes sense as the room for common errors is alleviated when the same steps you are taking are automated. Also, with ever increasing data needs, the infrastructure footprint is ever increasing. To meet this ever increasing demand, the only way for a team to scale is to adopt automation.</p>
<p>For example, being a SQL Server DBA, you might have been involved in server migration projects wherein you are tasked to migrate from older version of SQL server (SQL server 2008, SQL server 2008R2) to a more modern &amp; supported version (SQL server 2014, 2016, 2017, etc.).</p>
<p>In the stone age (before dbatools), we as DBA&rsquo;s spent countless hours scripting pre-migration tasks like logins, SQL Agent jobs, linked servers, system database custom objects, resource governor settings, certificates, etc. Even doing all this effort, often we miss few critical things due to non-standard process. dbatools takes care of the entire migration including pre-migration steps and migrating all or few databases from one instance to another along with error handling and logging. This is awesome, isn&rsquo;t it?</p>
<p>Once good thing about dbatools is that it has lots of commands to get all kinds of information that you want to gather. The commands name have the prefix&nbsp;<strong>Get-Dba*</strong>. Another beauty is the ability to pipe the output of the commands and write to SQL tables using <a href="https://dbatools.io/Write-DbaDataTable">Write-DbaDataTable</a> command.</p>
<p>In a large organization where you have hundreds of servers to manage and you often face a situation where you want to query all your SQL server estate. For example, checking total RAM and the max memory setting or you want to get version and service pack info for your entire SQL Server estate. Doing these tasks single threaded against a ton of servers is often painful because it takes lot of time!</p>
<h2>Multithreading to the rescue</h2>
<h4>What is multithreading and how does PowerShell offer multithreading?</h4>
<p>In simple terms, multithreading is the ability to run multiple threads on same or separate processors at the same time resulting in parallel execution.</p>
<p>PowerShell provides many ways to allow multi-threading in your scripts. Let&rsquo;s explore the most common ways:</p>
<ul>
<li><strong>Background jobs:</strong> A powerful way of allowing commands to run in the background and then retrieve the results later thereby freeing up the terminal and allowing the users to continue their work without interruption. Whenever a new job is started using <code>Start-Job</code>, it ends up spawning a new <code>powershell.exe</code> process which you can easily see using windows task manager or just running <code>Get-Process</code> command. This means that the more background jobs you run, the more <code>powershell.exe</code> processes are created which is a resource hog! Also, there is no ability to throttle the jobs (i.e. all jobs are started and executed at the same time). There is limited ability to manage multiple threads and have them share variables as well.
</li>
<li>
<p><strong>PowerShell Runspaces:</strong> A powerful and flexible way of leveraging .NET&rsquo;s <a href="https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.runspaces?redirectedfrom=MSDN&amp;view=powershellsdk-1.1.0" target="_blank" rel="noopener"><code>system.management.automation.runspaces</code></a> namespace that exposes variety of classes designed to create, manipulate and orchestrate a pool of PowerShell processes. In simple terms, think of Runspaces as containers where everything is contained or stored and ran in an asynchronous fashion.</p>
</li>
</ul>
<h4>How to efficiently leverage PowerShell Runspaces with high performance and less overhead ?</h4>
<p>Boe Prox has open sourced his awesome <a href="https://github.com/proxb/PoshRSJob">PoshRSJob module</a> that provides an alternative to native PowerShell jobs with greater performance and less overhead to run commands in the background, freeing up the console and allowing throttling on the jobs.</p>
<p>We can use this module to leverage multi-threading in dbatools as well. The PoshRSJob module is <a href="https://learn-powershell.net/2015/03/31/introducing-poshrsjob-as-an-alternative-to-powershell-jobs/">well-documented</a>, so in this blog post, I will just get into the details of how to leverage PoshRSJob module with dbatools.</p>
<p>As of writing this blog post, there are total of 514 functions in 0.9.722 version of dbatools out of which 192 are for fetching data (Get-Dba*) from your SQL server instances. How did I get those? Easy enough:</p>
<pre class="lang:ps decode:true "># How many functions are there in dbatools?
Get-Command -Module dbatools -Type Function | Measure-Object

# How many functions are there in dbatools that fetch data from SQL Server instances?
Get-Command -Module dbatools -Verb Get | Where CommandType -eq Function | Measure-Object</pre>
<p>Now let&rsquo;s say you are tasked to get all the databases that are part of a given Availability Group. There are two ways to approach this: the traditional (sequential) way and multithreading.</p>
<h4>The traditional sequential way</h4>
<pre class="lang:ps decode:true"># Get the list of servers. You can read directly from a text file or you can connect to your central database to get the list using tsql.
$servers = Get-Content D:\DBA\serverList.txt

# store credential in a variable which will be used for SQL authentication to your sql servers
$cred = Get-Credential -UserName sqladmin -Message "Enter your sqladmin Password"

# use foreach to loop through the collection and get the desired data
foreach ($server in $servers) {
    # here you can use any dbatools commands (Get-Dba*)
    Get-DbaAgDatabase -SqlInstance $server -SqlCredential $cred
}
</pre>
<h4>Using PoshRSJob module to leverage Runspaces &amp; Multithreading</h4>
<pre class="lang:ps decode:true"># Get the list of servers. You can read directly from a text file or you can connect to your central database to get the list using tsql.
$servers = Get-Content D:\DBA\serverList.txt

# store credential in a variable which will be used for SQL authentication to your SQL Servers
$cred = Get-Credential -UserName sqladmin -Message "Enter your sqladmin Password"

# PoshRSJob has throttle parameter. I usually keep it to the number of processors installed on the server
$throttle = $env:NUMBER_OF_PROCESSORS

# Multithread! See below for a breakdown
Start-RSJob -InputObject $servers -Throttle $throttle -ModulesToImport dbatools -ScriptBlock {
    Param($server)
    Get-DbaAgDatabase -SqlInstance $server -SqlCredential $Using:cred
}

# Get-RSJob will display all jobs that are currently available to include completed and currently running jobs.
# Receive-RSJob Gets the results of the Windows PowerShell runspace jobs in the current session. Also you can use -OutVariable variableName e.g. -OutVariable Results and then do $Results to get all the output
Get-RSJob | Where-Object  {{State -like "Completed"} -and  {HasMoreData -like "False"} -and {HasErrors -like "False"} }  | Receive-RSJob

# cleanup only the jobs that are completed, does not have more data and no errors
Get-RSJob | Where-Object  {{State -like "Completed"} -and  {HasMoreData -like "False"} -and {HasErrors -like "False"} } | Remove-RSJob</pre>
<h4>Breakdown</h4>
<pre class="lang:ps decode:true ">-InputObject $servers</pre>
<p>Here we are passing the collection item &ndash; <code>$servers</code> as an input object that will take that object and use it as the first parameter in the script block as long as you add a Param() block in it.</p>
<pre class="lang:ps decode:true">Param($server)</pre>
<p>This is added so that the -InputObject collection can be used as the first parameter</p>
<pre class="lang:ps decode:true">-ModulesToImport dbatools</pre>
<p>Here you can use any dbatools commands as all the commands are imported as part of the module import</p>
<pre class="lang:ps decode:true">-SqlCredential $Using:cred</pre>
<p>This is pretty cool way of passing a local variable to the script block i.e. you can use variables from parent PS Process into PSJob&rsquo;s scriptblock</p>
<p>On a side note, if you want to get the results or output of <code>Start-RSJob</code> into a variable,&nbsp; you can do it using <code>$results = Get-RSJob | Receive-RSJob</code> or <code>Get-RSJob | Receive-RSJob -OutVariable Results</code>&nbsp;(now you can use <code>$Results</code> same like former example) and then you can work with the result set as usual, and even write the entire result set to a database using <code>Write-DbaDataTable</code>.</p>
<h2>Results</h2>
<p>Below test shows the performance difference between Sequential Execution vs Multithreaded execution using PoshRSJob:</p>
<ul>
<li>Total Servers in the serverList.txt: 134</li>
<li>Total No. of logical CPUs: 16</li>
</ul>
<table>
<thead>
<tr>
<th>dbatools command</th>
<th>Sequential Execution</th>
<th>PoshRSJob</th>
<th>PercentGain</th>
</tr>
</thead>
<tbody>
<tr>
<td>Get-DbaAgDatabase</td>
<td>TotalSeconds: <strong>123.13</strong></td>
<td>TotalSeconds: <span style="color: #ff6600;"><strong>30.75</strong></span></td>
<td><span style="color: #ff6600;">300.42 %</span></td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> When running using <code>Start-Job</code>, the CPU is pegged to 100% (since it spawns individual <code>powershell.exe</code>&nbsp;processes and does not have native throttling option) and it uses almost all the available RAM than the PoshRSJob. The execution time for <code>Start-Job</code>&nbsp;is more than double and exhaust CPU and available RAM on the machine.</p>
<p>References:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/powershell/developer/command/background-jobs" target="_blank" rel="noopener">Background jobs</a></li>
<li><a href="https://www.codeproject.com/Tips/895840/Multi-Threaded-PowerShell-Cookbook" target="_blank" rel="noopener">Multi Threaded PowerShell Cookbook</a></li>
<li><a href="https://github.com/proxb/PoshRSJob" target="_blank" rel="noopener">PoshRSJob</a></li>
</ul>
<p>Thanks for reading !<br>
~ <strong>Kin Shah</strong></p>
<p>Get in touch&nbsp;<a href="https://twitter.com/TheRockstarDBA" target="_blank" rel="noopener">@TheRockStarDBA&nbsp;</a>or at <a href="https://dba.stackexchange.com/users/8783/kin?tab=profile" target="_blank" rel="noopener">dba.se</a></p>

<div id="jp-relatedposts" class="jp-relatedposts">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>			</div>

	<footer class="entry-footer">
			</footer>
</article>


					
<div id="comments" class="comments-area">

	
			<h3 class="comments-title">
			7 thoughts on &ldquo;<span>multithreading commands</span>&rdquo;		</h3>

		
		<ol class="comment-list">
			    <li class="comment even thread-even depth-1" id="li-comment-39359">
        <article id="comment-39359" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Seth</b> </cite><a class="comment-time" href="https://dbatools.io/multithread/#comment-39359"><time datetime="2019-01-04T20:56:37+00:00">January 4, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/multithread/?replytocom=39359#respond" data-commentid="39359" data-postid="9344" data-belowelement="comment-39359" data-respondelement="respond" aria-label="Reply to Seth">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Hi, Kin,</p>
<p>Thank you for showing this to us.  I have seen improvements already!</p>
<p>I&rsquo;m wondering how you got the timed test results of the sequential executions versus the PoshRSJobs executions?</p>
<p>Thanks!</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment byuser comment-author-kin bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-39366">
        <article id="comment-39366" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Kin</b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/multithread/#comment-39366"><time datetime="2019-01-04T21:54:47+00:00">January 4, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/multithread/?replytocom=39366#respond" data-commentid="39366" data-postid="9344" data-belowelement="comment-39366" data-respondelement="respond" aria-label="Reply to Kin">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Hi Seth,</p>
<p>Glad you liked it. For measuring the execution, you can use </p>
<p>`Measure-Command {<br>
## your script here !<br>
}`</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment even depth-2" id="li-comment-40004">
        <article id="comment-40004" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f54a2a7274061f1b7530f5a7dffdca52?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Seth</b> </cite><a class="comment-time" href="https://dbatools.io/multithread/#comment-40004"><time datetime="2019-01-07T13:40:28+00:00">January 7, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/multithread/?replytocom=40004#respond" data-commentid="40004" data-postid="9344" data-belowelement="comment-40004" data-respondelement="respond" aria-label="Reply to Seth">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Kin,</p>
<p>Thank you for the tip. I might not be using it correctly, however.  For instance:</p>
<p>Measure-Command {<br>
  Start-RSJob &hellip; {<br>
    My script here&hellip;<br>
  }<br>
}</p>
<p>This just gives me how long it takes to get started, or rather, how long it takes to just execute the Start-RSJob command.  After this command is complete, there are still jobs that have not yet finished, and I would like to know how long it takes all the started jobs to complete.  Putting Measure-Command inside Start-RSJob just results in how long it takes each parallel command to complete. While I could sum this information, the problem is that I then don&rsquo;t see the output of the script I originally created.</p>
<p>Hope that makes sense!</p>
<p>Seth</p>
                                    </div>

            </div>

        </article>
    <ul class="children">
    <li class="comment byuser comment-author-kin bypostauthor odd alt depth-3" id="li-comment-40326">
        <article id="comment-40326" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Kin</b> <span>Post author</span></cite><a class="comment-time" href="https://dbatools.io/multithread/#comment-40326"><time datetime="2019-01-08T14:30:57+00:00">January 8, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/multithread/?replytocom=40326#respond" data-commentid="40326" data-postid="9344" data-belowelement="comment-40326" data-respondelement="respond" aria-label="Reply to Kin">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>I see what you are saying. I am not sure how you can get the timing of individual jobs. You may want to file an enhancement at <a href="https://github.com/proxb/PoshRSJob/issues" rel="nofollow ugc">https://github.com/proxb/PoshRSJob/issues</a> .</p>
                                    </div>

            </div>

        </article>
    </li>
</ul>
</li>
</ul>
</li>
    <li class="comment even thread-even depth-1" id="li-comment-39383">
        <article id="comment-39383" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/03f2cd770c36bda3d4c8c5039d8e3784?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/03f2cd770c36bda3d4c8c5039d8e3784?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/03f2cd770c36bda3d4c8c5039d8e3784?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/03f2cd770c36bda3d4c8c5039d8e3784?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/03f2cd770c36bda3d4c8c5039d8e3784?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Harshan</b> </cite><a class="comment-time" href="https://dbatools.io/multithread/#comment-39383"><time datetime="2019-01-05T00:19:46+00:00">January 5, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/multithread/?replytocom=39383#respond" data-commentid="39383" data-postid="9344" data-belowelement="comment-39383" data-respondelement="respond" aria-label="Reply to Harshan">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Kin,<br>
Really good article! While I don&rsquo;t get deep into the technical details, this is highly valuable information to lot of the tech folks. I&rsquo;ll be sure to share this with some of the tech community I know. Keep sharing and great to see your continued passion in what you do!</p>
<p>Harshan</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-68865">
        <article id="comment-68865" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/d39452b5ebd63041d73faa3ef8e8f5f3?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/d39452b5ebd63041d73faa3ef8e8f5f3?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/d39452b5ebd63041d73faa3ef8e8f5f3?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/d39452b5ebd63041d73faa3ef8e8f5f3?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d39452b5ebd63041d73faa3ef8e8f5f3?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">divya</b> </cite><a class="comment-time" href="https://dbatools.io/multithread/#comment-68865"><time datetime="2019-07-16T10:59:47+00:00">July 16, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/multithread/?replytocom=68865#respond" data-commentid="68865" data-postid="9344" data-belowelement="comment-68865" data-respondelement="respond" aria-label="Reply to divya">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>Is servers list is must to multi thread?</p>
                                    </div>

            </div>

        </article>
    </li>
    <li class="comment even thread-even depth-1" id="li-comment-69963">
        <article id="comment-69963" class="comment clearfix">

            <img alt src="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=60&amp;d=mm&amp;r=g" class="avatar avatar-60 photo jetpack-lazy-image" height="60" width="60" data-lazy-srcset="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=120&amp;d=mm&amp;r=g 2x" data-lazy-src="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=60&amp;is-pending-load=1#038;d=mm&amp;r=g" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 "><noscript><img alt="" src="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=60&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a59ad4b47d8c7fd4cb4ae137e6d2f91a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60"></noscript>
            <div class="comment-wrapper">

                <header class="comment-meta comment-author vcard">
                    <cite><b class="fn">Kin</b> </cite><a class="comment-time" href="https://dbatools.io/multithread/#comment-69963"><time datetime="2019-08-06T16:08:32+00:00">August 6, 2019</time></a><a rel="nofollow" class="comment-reply-link" href="https://dbatools.io/multithread/?replytocom=69963#respond" data-commentid="69963" data-postid="9344" data-belowelement="comment-69963" data-respondelement="respond" aria-label="Reply to Kin">Reply</a>                </header>

                
                <div class="comment-content entry-content">
                    <p>@Divya &ndash; sorry for replying late. </p>
<p>You can have a text file containing a list of servers or you can just query a central database and generate a list of servers that you want to query using multithreading.</p>
                                    </div>

            </div>

        </article>
    </li>
		</ol>

		
	
	
	
		<div id="respond" class="comment-respond">
							<h3 id="reply-title" class="comment-reply-title">Leave a Reply					<small><a rel="nofollow" id="cancel-comment-reply-link" href="https://dbatools.io/multithread/#respond" style="display:none;">Cancel reply</a></small>
				</h3>
						<form id="commentform" class="comment-form">
				<iframe title="Comment Form" src="https://jetpack.wordpress.com/jetpack-comment/?blogid=111052036&amp;postid=9344&amp;comment_registration=0&amp;require_name_email=1&amp;stc_enabled=1&amp;stb_enabled=1&amp;show_avatars=1&amp;avatar_default=mystery&amp;greeting=Leave+a+Reply&amp;greeting_reply=Leave+a+Reply+to+%25s&amp;color_scheme=light&amp;lang=en_US&amp;jetpack_version=8.4.2&amp;show_cookie_consent=10&amp;has_cookie_consent=0&amp;token_key=%3Bnormal%3B&amp;sig=0453e5a1cda969d12d54b15b90151e1b8d0f1641#parent=https%3A%2F%2Fdbatools.io%2Fmultithread%2F" style="width:100%; height: 430px; border:0;" name="jetpack_remote_comment" class="jetpack_remote_comment" id="jetpack_remote_comment" sandbox="allow-same-origin allow-top-navigation allow-scripts allow-forms allow-popups"></iframe>
									
					<script>
						document.addEventListener('DOMContentLoaded', function () {
							var commentForms = document.getElementsByClassName('jetpack_remote_comment');
							for (var i = 0; i < commentForms.length; i++) {
								commentForms[i].allowTransparency = false;
								commentForms[i].scrolling = 'no';
							}
						});
					</script>
					
							</form>
		</div>

		
		<input type="hidden" name="comment_parent" id="comment_parent" value="">

		<p class="akismet_comment_form_privacy_notice">This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" target="_blank" rel="nofollow noopener">Learn how your comment data is processed</a>.</p>
</div>

				
				</main>
			</div>

                            
<div id="secondary" class="widget-area sidebar" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://dbatools.io/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="Search">
			</form></aside><aside id="custom_html-3" class="widget_text widget widget_custom_html"><h2 class="widget-title">new book</h2><div class="textwidget custom-html-widget">dbatools in a month of lunches is now available in Manning's Early Access Program &#128640; <br>&nbsp;

<p align="center"><a href="https://dbatools.io/book"><img alt="dbatools meap" src="https://blog.netnerds.net/wp-content/uploads/2019/08/meap.png?w=800&amp;ssl=1" data-recalc-dims="1" data-lazy-src="https://blog.netnerds.net/wp-content/uploads/2019/08/meap.png?w=800&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " class=" jetpack-lazy-image"><noscript><img alt="dbatools meap" src="https://blog.netnerds.net/wp-content/uploads/2019/08/meap.png?w=800&amp;ssl=1" data-recalc-dims="1"></noscript></a></p>

Get the book now at <a href="https://dbatools.io/book">manning.com</a></div></aside><aside id="sticky-posts-2" class="widget widget_ultimate_posts"><h2 class="widget-title"><a href="https://dbatools.io/blog">posts</a></h2>

<div class="upw-posts hfeed">

  
      
        
        <article class="post-10008 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/aliases/" rel="bookmark">
                  <img width="300" height="155" src="https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?fit=300%2C155&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?w=905&amp;ssl=1 905w, https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?resize=300%2C155&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?resize=768%2C396&amp;ssl=1 768w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://dbatools.io/wp-content/uploads/2020/01/cli12a.png?fit=300%2C155&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/aliases/" rel="bookmark">
                  working with sql client aliases                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-10124 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/bits2020/" rel="bookmark">
                  <img width="300" height="108" src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/bits2020/" rel="bookmark">
                  Vote for these SQLBits 2020 PowerShell sessions                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-10010 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/size/" rel="bookmark">
                  <img width="300" height="139" src="https://dbatools.io/wp-content/uploads/2019/09/disksize.png?fit=300%2C139&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2019/09/disksize.png?w=1139&amp;ssl=1 1139w, https://dbatools.io/wp-content/uploads/2019/09/disksize.png?resize=300%2C139&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2019/09/disksize.png?resize=768%2C355&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2019/09/disksize.png?resize=1024%2C473&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://dbatools.io/wp-content/uploads/2019/09/disksize.png?fit=300%2C139&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/size/" rel="bookmark">
                  working with file sizes in dbatools                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-9995 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements tag-book tag-dbatoolsmol tag-monthoflunches">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/meap/" rel="bookmark">
                  <img width="300" height="159" src="https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?fit=300%2C159&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?w=1287&amp;ssl=1 1287w, https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?resize=300%2C159&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?resize=768%2C408&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?resize=1024%2C543&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://dbatools.io/wp-content/uploads/2019/09/2019-09-04_13-00-161.png?fit=300%2C159&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/meap/" rel="bookmark">
                  Learn dbatools in a Month of Lunches                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-9928 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/oldapp/" rel="bookmark">
                  <img width="300" height="108" src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-src="https://dbatools.io/wp-content/uploads/2016/07/dbatools-for-post.png?fit=300%2C108&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/oldapp/" rel="bookmark">
                  migrating super old app databases                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
        
        <article class="post-9862 post type-post status-publish format-standard has-post-thumbnail hentry category-announcements tag-dbatools-configs tag-dbatools-settings tag-defaults">

          <header>

                          <div class="entry-image">
                <a href="https://dbatools.io/configuration/" rel="bookmark">
                  <img width="300" height="202" src="https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?fit=300%2C202&amp;ssl=1" class="attachment-medium size-medium wp-post-image jetpack-lazy-image" alt="" data-lazy-srcset="https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?w=1104&amp;ssl=1 1104w, https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?resize=300%2C202&amp;ssl=1 300w, https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?resize=768%2C516&amp;ssl=1 768w, https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?resize=1024%2C688&amp;ssl=1 1024w" data-lazy-sizes="(max-width: 300px) 100vw, 300px" data-lazy-src="https://dbatools.io/wp-content/uploads/2019/08/Get-DbatoolsConfig_Output.png?fit=300%2C202&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64 ,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 ">                </a>
              </div>
            
                          <h4 class="entry-title">
                <a href="https://dbatools.io/configuration/" rel="bookmark">
                  dbatools advanced configuration                </a>
              </h4>
            
            
          </header>

          
          <footer>

            
            
            
          </footer>

        </article>

      
  
</div>

</aside><aside id="blog_subscription-2" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title">subscribe</h2>
            <form action="#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
				                    <div id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
</div><p>Join 2,166 other subscribers</p>
                    <p id="subscribe-email">
                        <label id="jetpack-subscribe-label" class="screen-reader-text" for="subscribe-field-blog_subscription-2">
							email                        </label>
                        <input type="email" name="email" required="required" class="required" value="" id="subscribe-field-blog_subscription-2" placeholder="email">
                    </p>

                    <p id="subscribe-submit">
                        <input type="hidden" name="action" value="subscribe">
                        <input type="hidden" name="source" value="https://dbatools.io/multithread/">
                        <input type="hidden" name="sub-type" value="widget">
                        <input type="hidden" name="redirect_fragment" value="blog_subscription-2">
						                        <button type="submit" name="jetpack_subscriptions_widget">
	                        subscribe                        </button>
                    </p>
				            </form>
		
</aside><aside id="eu_cookie_law_widget-3" class="widget widget_eu_cookie_law_widget"><div class="hide-on-button" data-hide-timeout="30" data-consent-expiration="180" id="eu-cookie-law">
	<form method="post">
		<input type="submit" value="Close and accept" class="accept">
	</form>

	Privacy &amp; Cookies: This site uses cookies. By continuing to use this website, you agree to their use. <br>
To find out more, including how to control cookies, see here:
	<a href="https://automattic.com/cookies/">
		Cookie Policy	</a>
</div>
</aside></div>
            
		</div>
	</div>

    <footer id="colophon" class="site-footer" role="contentinfo">
                    <div class="footer-connect">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-2"></div>
                        
                        <div class="col-sm-8">
                                                            <div class="footer-social">
                                    <h5 class="follow-heading">dbatools on the web</h5><div class="footer-social-icons"><a target="_blank" href="http://git.io/b3oo" title="github"><i class="fa fa-github"></i></a><a target="_blank" href="https://www.youtube.com/channel/UC1qrq0zfswSM_Uf9-vBrsiw" title="YouTube"><i class="fa fa-youtube"></i></a><a target="_blank" href="https://dbatools.io/slack" title="Slack"><i class="fa fa-slack"></i></a><a target="_blank" href="https://twitter.com/psdbatools" title="Twitter"><i class="fa fa-twitter"></i></a><a target="_blank" href="https://www.linkedin.com/company/dbatools.io" title="LinkedIn"><i class="fa fa-linkedin-square fa-linkedin"></i></a><a target="_blank" href="https://twitch.tv/dbatools" title="Twitch"><i class="fa fa-twitch"></i></a><a target="_blank" href="https://dbatools.io/book" title="Manning"><i class="fa fa-book fa-manning"></i></a></div>                                </div>
                                                    </div>
                        <div class="col-sm-2"></div>
                    </div>
                </div>
            </div>
        
        <div class="site-info">
            <div class="container">
                                &copy; 2020 Chrissy LeMaire, PowerShell and SQL Server MVP<br><a href="https://dbatools.io/contact">Contact Us</a>            </div>
        </div>
        

    </footer>
</div>

	<div style="display:none">
	<div class="grofile-hash-map-f54a2a7274061f1b7530f5a7dffdca52">
	</div>
	<div class="grofile-hash-map-a59ad4b47d8c7fd4cb4ae137e6d2f91a">
	</div>
	<div class="grofile-hash-map-03f2cd770c36bda3d4c8c5039d8e3784">
	</div>
	<div class="grofile-hash-map-d39452b5ebd63041d73faa3ef8e8f5f3">
	</div>
	<div class="grofile-hash-map-a59ad4b47d8c7fd4cb4ae137e6d2f91a">
	</div>
	</div>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/photon/photon.min.js"></script>
<script type="text/javascript" src="https://secure.gravatar.com/js/gprofiles.js?ver=202035"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/modules/wpgroho.js"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/plugins.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/bootstrap.min.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/lightgallery.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/themes/onepress-master/assets/js/theme.js?ver=11.0.0"></script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/widgets/eu-cookie-law/eu-cookie-law.min.js"></script>
<script type="text/javascript" src="https://c0.wp.com/p/jetpack/8.4.2/_inc/build/lazy-images/js/lazy-images.min.js"></script>
<script type="text/javascript" src="https://dbatools.io/wp-content/plugins/onepress-plus/assets/js/onepress-plus.js?ver=10.1.8"></script>
<script async="async" type="text/javascript" src="https://dbatools.io/wp-content/plugins/akismet/_inc/form.js?ver=4.1.4"></script>

		
		<script type="text/javascript">
			(function () {
				var comm_par_el = document.getElementById( 'comment_parent' ),
					comm_par = ( comm_par_el && comm_par_el.value ) ? comm_par_el.value : '',
					frame = document.getElementById( 'jetpack_remote_comment' ),
					tellFrameNewParent;

				tellFrameNewParent = function () {
					if ( comm_par ) {
						frame.src = "https://jetpack.wordpress.com/jetpack-comment/?blogid=111052036&postid=9344&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=1&avatar_default=mystery&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=8.4.2&show_cookie_consent=10&has_cookie_consent=0&token_key=%3Bnormal%3B&sig=0453e5a1cda969d12d54b15b90151e1b8d0f1641#parent=https%3A%2F%2Fdbatools.io%2Fmultithread%2F" + '&replytocom=' + parseInt( comm_par, 10 ).toString();
					} else {
						frame.src = "https://jetpack.wordpress.com/jetpack-comment/?blogid=111052036&postid=9344&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=1&avatar_default=mystery&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=8.4.2&show_cookie_consent=10&has_cookie_consent=0&token_key=%3Bnormal%3B&sig=0453e5a1cda969d12d54b15b90151e1b8d0f1641#parent=https%3A%2F%2Fdbatools.io%2Fmultithread%2F";
					}
				};

				
				if ( 'undefined' !== typeof addComment ) {
					addComment._Jetpack_moveForm = addComment.moveForm;

					addComment.moveForm = function ( commId, parentId, respondId, postId ) {
						var returnValue = addComment._Jetpack_moveForm( commId, parentId, respondId, postId ),
							cancelClick, cancel;

						if ( false === returnValue ) {
							cancel = document.getElementById( 'cancel-comment-reply-link' );
							cancelClick = cancel.onclick;
							cancel.onclick = function () {
								var cancelReturn = cancelClick.call( this );
								if ( false !== cancelReturn ) {
									return cancelReturn;
								}

								if ( ! comm_par ) {
									return cancelReturn;
								}

								comm_par = 0;

								tellFrameNewParent();

								return cancelReturn;
							};
						}

						if ( comm_par == parentId ) {
							return returnValue;
						}

						comm_par = parentId;

						tellFrameNewParent();

						return returnValue;
					};
				}

				
				// Do the post message bit after the dom has loaded.
				document.addEventListener( 'DOMContentLoaded', function () {
					var iframe_url = "https:\/\/jetpack.wordpress.com";
					if ( window.postMessage ) {
						if ( document.addEventListener ) {
							window.addEventListener( 'message', function ( event ) {
								var origin = event.origin.replace( /^http:\/\//i, 'https://' );
								if ( iframe_url.replace( /^http:\/\//i, 'https://' ) !== origin ) {
									return;
								}
								jQuery( frame ).height( event.data );
							});
						} else if ( document.attachEvent ) {
							window.attachEvent( 'message', function ( event ) {
								var origin = event.origin.replace( /^http:\/\//i, 'https://' );
								if ( iframe_url.replace( /^http:\/\//i, 'https://' ) !== origin ) {
									return;
								}
								jQuery( frame ).height( event.data );
							});
						}
					}
				})

			})();
		</script>

		<script type="text/javascript" src="https://stats.wp.com/e-202035.js" async="async" defer></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:8.4.2',blog:'111052036',post:'9344',tz:'0',srv:'dbatools.io'} ]);
	_stq.push([ 'clickTrackerInit', '111052036', '9344' ]);
</script>

</body>
</html>
